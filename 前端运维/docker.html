<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Create or coding | Create or coding</title>
    <meta name="description" content="A VitePress site">
    <link rel="preload stylesheet" href="/assets/style.ae1251fb.css" as="style">
    <link rel="modulepreload" href="/assets/app.1c8695ff.js">
    <link rel="modulepreload" href="/assets/前端运维_docker.md.e371afdf.lean.js">
    
    <script>var _hmt=_hmt||[];(function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?af110c84612806edd3af36a0678759fb";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-93a960b4><!--[--><!--]--><!--[--><span tabindex="-1" data-v-151f2593></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-151f2593> Skip to content </a><!--]--><!----><header class="VPNav" data-v-93a960b4 data-v-0fa0e57d><div class="VPNavBar has-sidebar" data-v-0fa0e57d data-v-be450ad9><div class="container" data-v-be450ad9><div class="title" data-v-be450ad9><div class="VPNavBarTitle has-sidebar" data-v-be450ad9 data-v-6d2fb2d9><a class="title" href="/" data-v-6d2fb2d9><!--[--><!--]--><!----><!--[-->Code More Create<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-be450ad9><div class="curtain" data-v-be450ad9></div><div class="content-body" data-v-be450ad9><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-be450ad9 data-v-bdedfc22><span id="main-nav-aria-label" class="visually-hidden" data-v-bdedfc22>Main Navigation</span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-bdedfc22 data-v-96001b6b><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-96001b6b><span class="text" data-v-96001b6b><!----> js <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-96001b6b><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-96001b6b><div class="VPMenu" data-v-96001b6b data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-a5bbb52c><a class="VPLink link" href="/js/es6/1.let%E5%92%8Cconst%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E.html" data-v-a5bbb52c data-v-30c06bd3><!--[-->es6<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-a5bbb52c><a class="VPLink link" href="/js/interview/1.%E5%AE%9E%E7%8E%B0new%E5%AE%9E%E4%BE%8B%E5%8C%96%E5%AF%B9%E8%B1%A1.html" data-v-a5bbb52c data-v-30c06bd3><!--[-->interview<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-a5bbb52c><a class="VPLink link" href="/js/%E5%9F%BA%E7%A1%80/1.%E5%8F%AF%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87.html" data-v-a5bbb52c data-v-30c06bd3><!--[-->基础<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-bdedfc22 data-v-96001b6b><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-96001b6b><span class="text" data-v-96001b6b><!----> 前端运维 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-96001b6b><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-96001b6b><div class="VPMenu" data-v-96001b6b data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-a5bbb52c><a class="VPLink link" href="/%E5%89%8D%E7%AB%AF%E8%BF%90%E7%BB%B4/CICD.html" data-v-a5bbb52c data-v-30c06bd3><!--[-->CICD<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-a5bbb52c><a class="VPLink link active" href="/%E5%89%8D%E7%AB%AF%E8%BF%90%E7%BB%B4/docker.html" data-v-a5bbb52c data-v-30c06bd3><!--[-->docker<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-a5bbb52c><a class="VPLink link" href="/%E5%89%8D%E7%AB%AF%E8%BF%90%E7%BB%B4/linux%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4.html" data-v-a5bbb52c data-v-30c06bd3><!--[-->linux常见命令<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-a5bbb52c><a class="VPLink link" href="/%E5%89%8D%E7%AB%AF%E8%BF%90%E7%BB%B4/nginx.html" data-v-a5bbb52c data-v-30c06bd3><!--[-->nginx<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-a5bbb52c><a class="VPLink link" href="/%E5%89%8D%E7%AB%AF%E8%BF%90%E7%BB%B4/vim.html" data-v-a5bbb52c data-v-30c06bd3><!--[-->vim<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-bdedfc22 data-v-96001b6b><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-96001b6b><span class="text" data-v-96001b6b><!----> 网络 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-96001b6b><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-96001b6b><div class="VPMenu" data-v-96001b6b data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-a5bbb52c><a class="VPLink link" href="/%E7%BD%91%E7%BB%9C/http.html" data-v-a5bbb52c data-v-30c06bd3><!--[-->http<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-a5bbb52c><a class="VPLink link" href="/%E7%BD%91%E7%BB%9C/https.html" data-v-a5bbb52c data-v-30c06bd3><!--[-->https<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-a5bbb52c><a class="VPLink link" href="/%E7%BD%91%E7%BB%9C/tcp.html" data-v-a5bbb52c data-v-30c06bd3><!--[-->tcp<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/README.html" data-v-bdedfc22 data-v-95f5d58b data-v-30c06bd3><!--[-->README<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="https://algorithm.wendaobai.top" target="_blank" rel="noreferrer" data-v-bdedfc22 data-v-95f5d58b data-v-30c06bd3><!--[-->🏄🏻‍♂️ 算法笔记<!--]--><!----></a><!--]--><!--]--></nav><!----><!----><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-be450ad9 data-v-2ab2a029 data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://github.com/wendaobai" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-be450ad9 data-v-66bb1f24 data-v-96001b6b><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-96001b6b><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-96001b6b><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-96001b6b><div class="VPMenu" data-v-96001b6b data-v-e7ea1737><!----><!--[--><!--[--><!----><!----><div class="group" data-v-66bb1f24><div class="item social-links" data-v-66bb1f24><div class="VPSocialLinks social-links-list" data-v-66bb1f24 data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://github.com/wendaobai" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-be450ad9 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav" data-v-93a960b4 data-v-2817d72e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2817d72e><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-2817d72e><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-2817d72e>Menu</span></button><a class="top-link" href="#" data-v-2817d72e>Return to top</a></div><aside class="VPSidebar" data-v-93a960b4 data-v-c79ccefa><div class="curtain" data-v-c79ccefa></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-c79ccefa><span class="visually-hidden" id="sidebar-aria-label" data-v-c79ccefa> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-c79ccefa><section class="VPSidebarItem level-0 collapsible has-active" data-v-c79ccefa data-v-b05232f3><div class="item" role="button" data-v-b05232f3><div class="indicator" data-v-b05232f3></div><a class="VPLink link" data-v-b05232f3 data-v-30c06bd3><!--[--><h2 class="text" data-v-b05232f3>前端运维</h2><!--]--><!----></a><div class="caret" role="button" data-v-b05232f3><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-b05232f3><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-b05232f3><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b05232f3 data-v-b05232f3><div class="item" data-v-b05232f3><div class="indicator" data-v-b05232f3></div><a class="VPLink link link" href="/%E5%89%8D%E7%AB%AF%E8%BF%90%E7%BB%B4/CICD.html" data-v-b05232f3 data-v-30c06bd3><!--[--><p class="text" data-v-b05232f3>CICD</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link is-active has-active" data-v-b05232f3 data-v-b05232f3><div class="item" data-v-b05232f3><div class="indicator" data-v-b05232f3></div><a class="VPLink link link" href="/%E5%89%8D%E7%AB%AF%E8%BF%90%E7%BB%B4/docker.html" data-v-b05232f3 data-v-30c06bd3><!--[--><p class="text" data-v-b05232f3>docker</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b05232f3 data-v-b05232f3><div class="item" data-v-b05232f3><div class="indicator" data-v-b05232f3></div><a class="VPLink link link" href="/%E5%89%8D%E7%AB%AF%E8%BF%90%E7%BB%B4/linux%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4.html" data-v-b05232f3 data-v-30c06bd3><!--[--><p class="text" data-v-b05232f3>linux常见命令</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b05232f3 data-v-b05232f3><div class="item" data-v-b05232f3><div class="indicator" data-v-b05232f3></div><a class="VPLink link link" href="/%E5%89%8D%E7%AB%AF%E8%BF%90%E7%BB%B4/nginx.html" data-v-b05232f3 data-v-30c06bd3><!--[--><p class="text" data-v-b05232f3>nginx</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b05232f3 data-v-b05232f3><div class="item" data-v-b05232f3><div class="indicator" data-v-b05232f3></div><a class="VPLink link link" href="/%E5%89%8D%E7%AB%AF%E8%BF%90%E7%BB%B4/vim.html" data-v-b05232f3 data-v-30c06bd3><!--[--><p class="text" data-v-b05232f3>vim</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-93a960b4 data-v-0bd490fb><div class="VPDoc has-sidebar has-aside" data-v-0bd490fb data-v-c5936a1e><div class="container" data-v-c5936a1e><div class="aside" data-v-c5936a1e><div class="aside-curtain" data-v-c5936a1e></div><div class="aside-container" data-v-c5936a1e><div class="aside-content" data-v-c5936a1e><div class="VPDocAside" data-v-c5936a1e data-v-cdc66372><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-cdc66372 data-v-5dd9d5f6><div class="content" data-v-5dd9d5f6><div class="outline-marker" data-v-5dd9d5f6></div><div class="outline-title" data-v-5dd9d5f6>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-5dd9d5f6><span class="visually-hidden" id="doc-outline-aria-label" data-v-5dd9d5f6> Table of Contents for current page </span><ul class="root" data-v-5dd9d5f6 data-v-1188541a><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-cdc66372></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-c5936a1e><div class="content-container" data-v-c5936a1e><!--[--><!--]--><main class="main" data-v-c5936a1e><div style="position:relative;" class="vp-doc _%E5%89%8D%E7%AB%AF%E8%BF%90%E7%BB%B4_docker" data-v-c5936a1e><div><p>docker</p><h2 id="什么是docker" tabindex="-1">什么是docker <a class="header-anchor" href="#什么是docker" aria-hidden="true">#</a></h2><ul><li><p>软件部署的问题：如果要让软件运行起来，就必须保证操作系统设置环境，保证各自库与组件都能安装运行</p></li><li><p>虚拟机就是带环境安装的解决方案，它可以在一种操作系统中运行另一种操作系统</p><p>问题：</p><ul><li>资源占用多</li><li>冗余步骤多</li><li>启动速度慢</li></ul></li><li><p>Linux容器化</p><p>由于虚拟机存在这些缺点，Linux 发展出了另一种虚拟化技术：Linux 容器（Linux Containers，缩写为 LXC）。</p><p>Linux 容器不是模拟一个完整的操作系统，而是对进程进行隔离。或者说，在正常进程的外面套了一个保护层。对于容器里面的进程来说，它接触到的各种资源都是虚拟的，从而实现与底层系统的隔离。</p><ul><li>启动快</li><li>资源占用少</li><li>体积小</li></ul></li><li><p>Docker 属于 Linux 容器的一种封装，提供简单易用的容器使用接口。它是目前最流行的 Linux 容器解决方案</p></li><li><p>Docker 将应用程序与该程序的依赖，打包在一个文件里面。运行这个文件，就会生成一个虚拟容器。程序在这个虚拟容器里运行，就好像在真实的物理机上运行一样</p></li></ul><h2 id="docker和kvm" tabindex="-1">docker和KVM <a class="header-anchor" href="#docker和kvm" aria-hidden="true">#</a></h2><p>docker是虚拟一个微服务所需要的环境容器，kvm是硬件虚拟化，虚拟一个操作系统</p><ul><li>启动时间 <ul><li>Docker秒级启动</li><li>KVM分钟级启动</li></ul></li><li>轻量级 容器镜像通常以M为单位，虚拟机以G为单位，容器资源占用小，要比虚拟要部署更快速 <ul><li>容器共享宿主机内核，系统级虚拟化，占用资源少，容器性能基本接近物理机</li><li>虚拟机需要虚拟化一些设备，具有完整的OS,虚拟机开销大，因而降低性能，没有容器性能好</li></ul></li><li>安全性 <ul><li>由于共享宿主机内核，只是进程隔离，因此隔离性和稳定性不如虚拟机，容器具有一定权限访问宿主机内核，存在一下安全隐患</li></ul></li><li>使用要求 <ul><li>KVM基于硬件的完全虚拟化，需要硬件CPU虚拟化技术支持</li><li>容器共享宿主机内核，可运行在主机的Linux的发行版，不用考虑CPU是否支持虚拟化技术</li></ul></li></ul><h2 id="docker架构" tabindex="-1">docker架构 <a class="header-anchor" href="#docker架构" aria-hidden="true">#</a></h2><img src="/assets/image-20230314102457605.9326583b.png" alt="image-20230314102457605" style="zoom:50%;"><ul><li>containerd 是一个守护进程，使用runc管理容器，向Docker Engine提供接口</li><li>shim 只负责管理一个容器</li><li>runC是一个轻量级工具，只用来运行容器</li></ul><img src="/assets/image-20230314102615256.22656ba3.png" alt="image-20230314102615256" style="zoom:67%;"><p><code>Docker</code> 在运行时分为 <code>Docker 引擎（服务端守护进程）</code> 和 <code>客户端工具</code>，我们日常使用各种 <code>docker 命令</code>，其实就是在使用 <code>客户端工具</code> 与 <code>Docker 引擎</code> 进行交互。还有一个docker镜像仓库</p><h2 id="docker安装" tabindex="-1">docker安装 <a class="header-anchor" href="#docker安装" aria-hidden="true">#</a></h2><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-y</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">yum-utils</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">device-mapper-persistent-data</span><span style="color:#A6ACCD;">   </span><span style="color:#C3E88D;">lvm2</span></span>
<span class="line"><span style="color:#FFCB6B;">yum-config-manager</span><span style="color:#A6ACCD;">     </span><span style="color:#C3E88D;">--add-repo</span><span style="color:#A6ACCD;">     </span><span style="color:#C3E88D;">https://download.docker.com/linux/centos/docker-ce.repo</span></span>
<span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker-ce</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker-ce-cli</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">containerd.io</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-y</span></span>
<span class="line"></span></code></pre></div><h3 id="启动" tabindex="-1">启动 <a class="header-anchor" href="#启动" aria-hidden="true">#</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">start</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># </span></span>
<span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">vesion</span></span>
<span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">info</span></span>
<span class="line"><span style="color:#FFCB6B;">systemctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">stop</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker</span></span>
<span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">remove</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># 卸载docker</span></span>
<span class="line"><span style="color:#FFCB6B;">rm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-rf</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/var/lib/docker</span></span>
<span class="line"></span></code></pre></div><h2 id="镜像image" tabindex="-1">镜像image <a class="header-anchor" href="#镜像image" aria-hidden="true">#</a></h2><ul><li>Docker将运用程序和依赖包打包在Image中，只有通过image才能生成docker容器</li><li>image可以看成docker容器的模板,类似class,容器就是实例</li><li>Docker 根据 image 文件生成容器的实例</li><li>同一个 image 文件，可以生成多个同时运行的容器实例</li><li>镜像不是一个单一的文件，而是有多层，类似运输车的集装箱的堆集</li><li>容器其实就是在镜像的最上面加了一层读写层，在运行容器里做的任何文件改动，都会写到这个读写层里。如果容器删除了，最上面的读写层也就删除了，改动也就丢失了</li><li>我们可以通过<code>docker history &lt;ID/NAME&gt;</code> 查看镜像中各层内容及大小，每层对应着<code>Dockerfile</code>中的一条指令</li></ul><h3 id="image的相关指令" tabindex="-1">image的相关指令 <a class="header-anchor" href="#image的相关指令" aria-hidden="true">#</a></h3><table><thead><tr><th style="text-align:left;">命令</th><th style="text-align:left;">含义</th><th style="text-align:left;">语法</th><th style="text-align:left;">案例</th></tr></thead><tbody><tr><td style="text-align:left;">ls</td><td style="text-align:left;">查看全部镜像</td><td style="text-align:left;">docker image ls</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">search</td><td style="text-align:left;">查找镜像</td><td style="text-align:left;">docker search [imageName]</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">history</td><td style="text-align:left;">查看镜像历史</td><td style="text-align:left;">docker history [imageName]</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">inspect</td><td style="text-align:left;">显示一个或多个镜像详细信息</td><td style="text-align:left;">docker inspect [imageName]</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">pull</td><td style="text-align:left;">拉取镜像</td><td style="text-align:left;">docker pull [imageName]</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">push</td><td style="text-align:left;">推送一个镜像到镜像仓库</td><td style="text-align:left;">docker push [imageName]</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">rmi</td><td style="text-align:left;">删除镜像</td><td style="text-align:left;">docker rmi [imageName] docker image rmi 2</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">prune</td><td style="text-align:left;">移除未使用的镜像，没有标记或补任何容器引用</td><td style="text-align:left;">docker image prune</td><td style="text-align:left;">docker image prune</td></tr><tr><td style="text-align:left;">tag</td><td style="text-align:left;">标记本地镜像，将其归入某一仓库</td><td style="text-align:left;">docker tag [OPTIONS] IMAGE[:TAG] [REGISTRYHOST/][USERNAME/]NAME[:TAG]</td><td style="text-align:left;">docker tag centos:7 zhangrenyang/centos:v1</td></tr><tr><td style="text-align:left;">export</td><td style="text-align:left;">将容器文件系统作为一个tar归档文件导出到STDOUT</td><td style="text-align:left;">docker export [OPTIONS] CONTAINER</td><td style="text-align:left;">docker export -o hello-world.tar b2712f1067a3</td></tr><tr><td style="text-align:left;">import</td><td style="text-align:left;">导入容器快照文件系统tar归档文件并创建镜像</td><td style="text-align:left;">docker import [OPTIONS] file/URL/- [REPOSITORY[:TAG]]</td><td style="text-align:left;">docker import hello-world.tar</td></tr><tr><td style="text-align:left;">save</td><td style="text-align:left;">将指定镜像保存成<code>tar</code>文件</td><td style="text-align:left;">docker save [OPTIONS] IMAGE [IMAGE...]</td><td style="text-align:left;">docker save -o hello-world.tar hello-world:latest</td></tr><tr><td style="text-align:left;">load</td><td style="text-align:left;">加载tar文件并创建镜像</td><td style="text-align:left;"></td><td style="text-align:left;">docker load -i hello-world.tar</td></tr><tr><td style="text-align:left;">build</td><td style="text-align:left;">根据Dockerfile构建镜像</td><td style="text-align:left;">docker build [OPTIONS] PATH / URL / -</td><td style="text-align:left;">docker build -t zf/ubuntu:v1 .</td></tr></tbody></table><h2 id="容器container" tabindex="-1">容器container <a class="header-anchor" href="#容器container" aria-hidden="true">#</a></h2><ul><li><code>docker run</code> 命令会从 <code>image</code> 文件，生成一个正在运行的容器实例。</li><li><code>docker container run</code>命令具有自动抓取 image 文件的功能。如果发现本地没有指定的 image 文件，就会从仓库自动抓取</li><li>输出提示以后，hello world就会停止运行，容器自动终止。</li><li>有些容器不会自动终止</li><li>image 文件生成的容器实例，本身也是一个文件，称为容器文件</li><li>容器生成，就会同时存在两个文件： image 文件和容器文件</li><li>关闭容器并不会删除容器文件，只是容器停止运行</li></ul><h3 id="container-命令" tabindex="-1">container 命令 <a class="header-anchor" href="#container-命令" aria-hidden="true">#</a></h3><table><thead><tr><th>run</th><th>从镜像运行一个容器</th><th>docker run ubuntu /bin/echo &#39;hello-world&#39;</th></tr></thead><tbody><tr><td>ls</td><td>列出容器</td><td>docker container ls</td></tr><tr><td>inspect</td><td>显示一个或多个容器详细信息</td><td>docker inspect</td></tr><tr><td>attach</td><td>要attach上去的容器必须正在运行，可以同时连接上同一个container来共享屏幕</td><td>docker attach [OPTIONS] CONTAINER<br>docker attach 6d1a25f95132</td></tr><tr><td>stats</td><td>显示容器资源使用统计</td><td>docker container stats</td></tr><tr><td>top</td><td>停止一个容器运行的进程</td><td>docker container top</td></tr><tr><td>update</td><td>更新一个或多个容器配置</td><td>docker update -m 500m --memory-swap -1 6d1a25f95132</td></tr><tr><td>port</td><td>列出指定的容器的端口映射</td><td>docker run -d -p 8080:80 nginx docker container port containerID</td></tr><tr><td>ps</td><td>查看当前运行的容器</td><td>docker ps -a -l</td></tr><tr><td>kill [containerId]</td><td>终止容器(发送SIGKILL )</td><td>docker kill [containerId]</td></tr><tr><td>rm [containerId]</td><td>删除容器</td><td>docker rm [containerId]</td></tr><tr><td>start [containerId]</td><td>启动已经生成、已经停止运行的容器文件</td><td>docker start [containerId]</td></tr><tr><td>stop [containerId]</td><td>终止容器运行 (发送 SIGTERM )</td><td>docker stop [containerId] docker container stop $(docker container ps -aq)</td></tr><tr><td>logs [containerId]</td><td>查看 docker 容器的输出</td><td>docker logs [containerId]</td></tr><tr><td>exec [containerId]</td><td>进入一个正在运行的 docker 容器执行命令</td><td>docker container exec -it f6a53629488b /bin/bash</td></tr><tr><td>cp [containerId]</td><td>从正在运行的 Docker 容器里面，将文件拷贝到本机</td><td>docker container cp f6a53629488b:/root/root.txt .</td></tr><tr><td>commit [containerId]</td><td>根据一个现有容器创建一个新的镜像</td><td>docker commit -a &quot;zhufeng&quot; -m &quot;mynginx&quot; a404c6c174a2 mynginx:v1</td></tr></tbody></table><p>docker容器的主线程（dockfile中CMD执行的命令）结束，容器会退出</p><ul><li>以使用交互式启动 <code>docker run -i [CONTAINER_NAME or CONTAINER_ID]</code></li><li>tty选项 <code>docker run -dit [CONTAINER_NAME or CONTAINER_ID]</code></li><li>守护态（Daemonized）形式运行 <code>docker run -d ubuntu /bin/sh -c &quot;while true; do echo hello world; sleep 1; done&quot;</code></li></ul><h3 id="启动容器" tabindex="-1">启动容器 <a class="header-anchor" href="#启动容器" aria-hidden="true">#</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">run</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ubuntu</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/bin/echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Hello world</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><ul><li>docker: Docker 的二进制执行文件。</li><li>run:与前面的 docker 组合来运行一个容器。</li><li>ubuntu指定要运行的镜像，Docker首先从本地主机上查找镜像是否存在，如果不存在，Docker 就会从镜像仓库 Docker Hub 下载公共镜像。</li><li>/bin/echo &quot;Hello world&quot;: 在启动的容器里执行的命令</li></ul><blockquote><p>Docker以ubuntu镜像创建一个新容器，然后在容器里执行 bin/echo &quot;Hello world&quot;，然后输出结果</p><ul><li>Docker attach必须是登陆到一个已经运行的容器里。需要注意的是如果从这个容器中exit退出的话，就会导致容器停止</li></ul></blockquote><table><thead><tr><th style="text-align:left;">参数</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">-i --interactive</td><td style="text-align:left;">交互式</td></tr><tr><td style="text-align:left;">-t --tty</td><td style="text-align:left;">分配一个伪终端</td></tr><tr><td style="text-align:left;">-d --detach</td><td style="text-align:left;">运行容器到后台</td></tr><tr><td style="text-align:left;">-a --attach list</td><td style="text-align:left;">附加到运行的容器</td></tr><tr><td style="text-align:left;">-e --env list</td><td style="text-align:left;">设置环境变量</td></tr><tr><td style="text-align:left;">-p --publish list</td><td style="text-align:left;">发布容器端口到主机</td></tr><tr><td style="text-align:left;">-P</td><td style="text-align:left;">--publish-all</td></tr></tbody></table><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">run</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-d</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1010</span><span style="color:#C3E88D;">:</span><span style="color:#F78C6C;">80</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-e</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">username=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">zhufeng</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span><span style="color:#A6ACCD;"> \ </span><span style="color:#C3E88D;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">container</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">exec</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-it</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">3695dc5b9c2d</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/bin/bash</span></span>
<span class="line"></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">run</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--name</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx-test</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">8080</span><span style="color:#C3E88D;">:</span><span style="color:#F78C6C;">80</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-d</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"></span></code></pre></div><p>--name 容器名称</p><h4 id="进入一个正在运行的容器" tabindex="-1">进入一个正在运行的容器 <a class="header-anchor" href="#进入一个正在运行的容器" aria-hidden="true">#</a></h4><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">container</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">exec</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-it</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">containerID</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/bin/bash</span></span>
<span class="line"></span></code></pre></div><h4 id="容器的端口映射" tabindex="-1">容器的端口映射 <a class="header-anchor" href="#容器的端口映射" aria-hidden="true">#</a></h4><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">run</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-d</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">8080</span><span style="color:#C3E88D;">:</span><span style="color:#F78C6C;">80</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"></span></code></pre></div><h3 id="容器制作个性化image" tabindex="-1">容器制作个性化image <a class="header-anchor" href="#容器制作个性化image" aria-hidden="true">#</a></h3><ul><li>docker commit :从容器创建一个新的镜像。</li><li>docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]] <ul><li>-a :提交的镜像作者</li><li>-c :使用Dockerfile指令来创建镜像</li><li>-m :提交时的说明文字</li><li>-p :在commit时，将容器暂停</li></ul></li><li>停止容器后不会自动删除这个容器，除非在启动容器的时候指定了 --rm 标志</li><li>使用 docker ps -a 命令查看 Docker 主机上包含停止的容器在内的所有容器</li><li>停止状态的容器的可写层仍然占用磁盘空间。要清理可以使用 <code>docker container prune</code> 命令</li></ul><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">container</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">commit</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">my-nginx</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-a</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">zs</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">3695dc5b9c2d</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">zs/mynginx:v1</span></span>
<span class="line"></span></code></pre></div><h2 id="dockerfile文件" tabindex="-1">Dockerfile文件 <a class="header-anchor" href="#dockerfile文件" aria-hidden="true">#</a></h2><ul><li>Docker 的镜像是用一层一层的文件组成的</li><li><code>docker inspect</code>命令可以查看镜像或者容器</li><li>Layers就是镜像的层文件，只读不能修改。基于镜像创建的容器会共享这些文件层</li></ul><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">inspect</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"></span></code></pre></div><h3 id="指令" tabindex="-1">指令 <a class="header-anchor" href="#指令" aria-hidden="true">#</a></h3><table><thead><tr><th style="text-align:left;">指令</th><th style="text-align:left;">含义</th><th style="text-align:left;">示例</th></tr></thead><tbody><tr><td style="text-align:left;">FROM</td><td style="text-align:left;">构建的新镜像是基于哪个镜像</td><td style="text-align:left;">FROM centos:6</td></tr><tr><td style="text-align:left;">MAINTAINER</td><td style="text-align:left;">镜像维护者姓名或邮箱地址</td><td style="text-align:left;">MAINTAINER zhufengjiagou</td></tr><tr><td style="text-align:left;">RUN</td><td style="text-align:left;">构建镜像时运行的shell命令</td><td style="text-align:left;">RUN yum install httpd</td></tr><tr><td style="text-align:left;">CMD</td><td style="text-align:left;">CMD 设置容器启动后默认执行的命令及其参数，但 CMD 能够被 docker run 后面跟的命令行参数替换</td><td style="text-align:left;">CMD /usr/sbin/sshd -D</td></tr><tr><td style="text-align:left;">EXPOSE</td><td style="text-align:left;">声明容器运行的服务器端口</td><td style="text-align:left;">EXPOSE 80 443</td></tr><tr><td style="text-align:left;">ENV</td><td style="text-align:left;">设置容器内的环境变量</td><td style="text-align:left;">ENV MYSQL_ROOT_PASSWORD 123456</td></tr><tr><td style="text-align:left;">ADD</td><td style="text-align:left;">拷贝文件或目录到镜像中，如果是URL或者压缩包会自动下载和解压</td><td style="text-align:left;">ADD ,ADD <a href="https://xxx.com/html.tar.gz" target="_blank" rel="noreferrer">https://xxx.com/html.tar.gz</a> /var/<a href="http://www.html/" target="_blank" rel="noreferrer">www.html</a>, ADD html.tar.gz /var/www/html</td></tr><tr><td style="text-align:left;">COPY</td><td style="text-align:left;">拷贝文件或目录到镜像</td><td style="text-align:left;">COPY ./start.sh /start.sh</td></tr><tr><td style="text-align:left;">ENTRYPOINT</td><td style="text-align:left;">配置容器启动时运行的命令</td><td style="text-align:left;">ENTRYPOINT /bin/bash -c &#39;/start.sh&#39;</td></tr><tr><td style="text-align:left;">VOLUME</td><td style="text-align:left;">指定容器挂载点到宿主自动生成的目录或其它容器</td><td style="text-align:left;">VOLUME [&quot;/var/lib/mysql&quot;]</td></tr><tr><td style="text-align:left;">USER</td><td style="text-align:left;">为 RUN CMD和ENTRYPOINT执行命令指定运行用户</td><td style="text-align:left;">USER zhufengjiagou</td></tr><tr><td style="text-align:left;">WORKDIR</td><td style="text-align:left;">为RUN CMD ENTRYPOINT COPY ADD 设置工作目录</td><td style="text-align:left;">WORKDIR /data</td></tr><tr><td style="text-align:left;">HEALTHCHECK</td><td style="text-align:left;">健康检查</td><td style="text-align:left;">HEALTHCHECK --interval=5m --timeout=3s --retries=3 CMS curl -f htp://localhost</td></tr><tr><td style="text-align:left;">ARG</td><td style="text-align:left;">在构建镜像时指定一些参数</td><td style="text-align:left;">ARG user</td></tr></tbody></table><h3 id="dockerignore-表示要排除-不要打包到image中的文件路径" tabindex="-1">.dockerignore 表示要排除，不要打包到image中的文件路径 <a class="header-anchor" href="#dockerignore-表示要排除-不要打包到image中的文件路径" aria-hidden="true">#</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">.git</span></span>
<span class="line"><span style="color:#FFCB6B;">node_modules</span></span>
<span class="line"></span></code></pre></div><p>dockerfile</p><div class="language-dockerfile"><button title="Copy Code" class="copy"></button><span class="lang">dockerfile</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">FROM node</span></span>
<span class="line"><span style="color:#A6ACCD;">COPY ./app /app</span></span>
<span class="line"><span style="color:#A6ACCD;">WORKDIR /app</span></span>
<span class="line"><span style="color:#A6ACCD;">RUN npm install</span></span>
<span class="line"><span style="color:#A6ACCD;">EXPOSE 3000</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>创建image</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">build</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-t</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">express-demo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.</span></span>
<span class="line"></span></code></pre></div><ul><li>-t用来指定image镜像的名称，后面还可以加冒号指定标签，如果不指定默认就是latest</li><li><code>.</code> 表示Dockerfile文件的所有路径,<code>.</code>就表示当前路径</li></ul><p>运行生成容器并在后台运行</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">container</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">run</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3333</span><span style="color:#C3E88D;">:</span><span style="color:#F78C6C;">3000</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-it</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">express-demo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">start</span></span>
<span class="line"></span></code></pre></div><h4 id="cmd指令" tabindex="-1">cmd指令 <a class="header-anchor" href="#cmd指令" aria-hidden="true">#</a></h4><p>dockefile</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">FROM</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">node:15.10.0-slim</span></span>
<span class="line"><span style="color:#FFCB6B;">COPY</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">./app</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/app</span></span>
<span class="line"><span style="color:#FFCB6B;">WORKDIR</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/app</span></span>
<span class="line"><span style="color:#FFCB6B;">USER</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">root</span></span>
<span class="line"><span style="color:#FFCB6B;">RUN</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">--registry=https://registry.npm.taobao.org</span></span>
<span class="line"><span style="color:#FFCB6B;">EXPOSE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3000</span></span>
<span class="line"><span style="color:#FFCB6B;">CMD</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">npm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">start</span></span>
<span class="line"></span></code></pre></div><p>重新制作做镜像并运行容器</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">build</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-t</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">express-demo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.</span></span>
<span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">container</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">run</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3333</span><span style="color:#C3E88D;">:</span><span style="color:#F78C6C;">3000</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">express-demo</span></span>
<span class="line"></span></code></pre></div><ul><li>RUN命令在 image 文件的构建阶段执行，执行结果都会打包进入 image 文件；CMD命令则是在容器启动后执行</li><li>一个 Dockerfile 可以包含多个RUN命令，但是只能有一个CMD命令</li><li>指定了CMD命令以后，docker container run命令就不能附加命令了（比如前面的/bin/bash），否则它会覆盖CMD命令</li></ul><h2 id="数据卷volume" tabindex="-1">数据卷volume <a class="header-anchor" href="#数据卷volume" aria-hidden="true">#</a></h2><p>删除容器的时候，容器层里创建的文件也会被删除掉，如果有些数据你想永久保存，比如Web服务器的日志，数据库管理系统中的数据，可以为容器创建一个数据盘</p><img src="/assets/image-20230315143429170.10852ca8.png" alt="image-20230315143429170" style="zoom:50%;"><ul><li>volumes Docker管理宿主机文件系统的一部分(/var/lib/docker/volumes)</li><li>如果没有指定卷，则会自动创建</li><li>建议使用--mount ,更通用</li></ul><h2 id="网络设置" tabindex="-1">网络设置 <a class="header-anchor" href="#网络设置" aria-hidden="true">#</a></h2><ul><li>安装Docker时，它会自动创建三个网络，bridge（创建容器默认连接到此网络）、 none 、host <ul><li>None：该模式关闭了容器的网络功能,对外界完全隔离</li><li>host：容器将不会虚拟出自己的网卡，配置自己的IP等，而是使用宿主机的IP和端口。</li><li>bridge 桥接网络，此模式会为每一个容器分配IP</li></ul></li><li>可以使用该<code>--network</code>标志来指定容器应连接到哪些网络</li></ul><h2 id="compose" tabindex="-1">compose <a class="header-anchor" href="#compose" aria-hidden="true">#</a></h2><ul><li>Compose 通过一个配置文件来管理多个Docker容器</li><li>在配置文件中，所有的容器通过services来定义，然后使用docker-compose脚本来启动、停止和重启应用和应用中的服务以及所有依赖服务的容器</li><li>步骤： <ul><li>最后，运行<code>docker-compose up</code>，Compose 将启动并运行整个应用程序 配置文件组成</li><li>services 可以定义需要的服务，每个服务都有自己的名字、使用的镜像、挂载的数据卷所属的网络和依赖的其它服务</li><li>networks 是应用的网络，在它下面可以定义使用的网络名称，类性</li><li>volumes是数据卷，可以在此定义数据卷，然后挂载到不同的服务上面使用</li></ul></li></ul><p>安装</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-y</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">epel-release</span></span>
<span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-y</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">python-pip</span></span>
<span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">clean</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">all</span></span>
<span class="line"><span style="color:#FFCB6B;">pip</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">docker-compose</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 设置权限</span></span>
<span class="line"><span style="color:#FFCB6B;">curl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-L</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://get.daocloud.io/docker/compose/releases/download/v2.</span><span style="color:#F78C6C;">5.0</span><span style="color:#C3E88D;">/docker-compose-</span><span style="color:#89DDFF;">`</span><span style="color:#FFCB6B;">uname</span><span style="color:#C3E88D;"> -s</span><span style="color:#89DDFF;">`</span><span style="color:#FFCB6B;">-</span><span style="color:#89DDFF;">`</span><span style="color:#FFCB6B;">uname</span><span style="color:#C3E88D;"> -m</span><span style="color:#89DDFF;">`</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">/usr/local/bin/docker-compose</span></span>
<span class="line"><span style="color:#FFCB6B;">sudo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">chmod</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">+x</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/usr/local/bin/docker-compose</span></span>
<span class="line"><span style="color:#FFCB6B;">docker-compose</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--version</span></span>
<span class="line"></span></code></pre></div><p>docker-compose.yml文件</p><ul><li>在 <code>docker-compose.yml</code> 中定义组成应用程序的服务，以便它们可以在隔离的环境中一起运行</li><li>空格缩进表示层次</li><li>冒号空格后面有空格</li></ul><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#F07178;">version</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">services</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">nginx1</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">ports</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">8080:80</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">nginx2</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">ports</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">8081:80</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">docker-compose</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">up</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-d</span></span>
<span class="line"></span></code></pre></div><h3 id="启动命令" tabindex="-1">启动命令 <a class="header-anchor" href="#启动命令" aria-hidden="true">#</a></h3><table><thead><tr><th style="text-align:left;">命令</th><th style="text-align:left;">服务</th></tr></thead><tbody><tr><td style="text-align:left;">docker-compose up</td><td style="text-align:left;">启动所有的服务</td></tr><tr><td style="text-align:left;">docker-compose up -d</td><td style="text-align:left;">后台启动所有的服务</td></tr><tr><td style="text-align:left;">docker-compose ps</td><td style="text-align:left;">打印所有的容器</td></tr><tr><td style="text-align:left;">docker-compose stop</td><td style="text-align:left;">停止所有服务</td></tr><tr><td style="text-align:left;">docker-compose logs -f</td><td style="text-align:left;">持续跟踪日志</td></tr><tr><td style="text-align:left;">docker-compose exec nginx1 bash</td><td style="text-align:left;">进入nginx1服务系统</td></tr><tr><td style="text-align:left;">docker-compose rm nginx1</td><td style="text-align:left;">删除服务容器</td></tr><tr><td style="text-align:left;">docker network ls</td><td style="text-align:left;">查看网络网络不会删除</td></tr><tr><td style="text-align:left;">docker-compose down</td><td style="text-align:left;">删除所有的网络和容器</td></tr></tbody></table><blockquote><p>删除所有的容器 docker container rm <code>docker container ps -a -q</code></p></blockquote><h3 id="compose-配置数据卷volume" tabindex="-1">compose 配置数据卷volume <a class="header-anchor" href="#compose-配置数据卷volume" aria-hidden="true">#</a></h3><ul><li>networks 指定自定义网络</li><li>volumes 指定数据卷</li><li>数据卷在宿主机的位置 <code>/var/lib/docker/volumes/nginx-compose_data/_data</code></li></ul><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#F07178;">version</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">3</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">services</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">nginx1</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">ports</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">8081:80</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">networks</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">newweb</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">volumes</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">data:/data</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./nginx1:/usr/share/nginx/html</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">#容器与系统文件会同步</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">nginx2</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">ports</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">8082:80</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">networks</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">default</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">volumes</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">data:/data</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./nginx2:/usr/share/nginx/html</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">nginx3</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">ports</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">8083:80</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">networks</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">default</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">newweb</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">volumes</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">data:/data</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./nginx3:/usr/share/nginx/html</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#F07178;">networks</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">newweb</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">driver</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">bridge</span></span>
<span class="line"><span style="color:#F07178;">volumes</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">data</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">driver</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">local</span></span>
<span class="line"></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">docker-compose</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">up</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-d</span></span>
<span class="line"><span style="color:#FFCB6B;">docker</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">exec</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-itd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx-compose_nginx1_1</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">bash</span></span>
<span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/data</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#FFCB6B;">touch</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">1.txt</span></span>
<span class="line"><span style="color:#82AAFF;">exit</span></span>
<span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/var/lib/docker/volumes/nginx-compose_data/_data</span></span>
<span class="line"><span style="color:#FFCB6B;">ls</span></span>
<span class="line"></span></code></pre></div><h2 id="docker-compose-搭建node项目" tabindex="-1">docker compose 搭建node项目 <a class="header-anchor" href="#docker-compose-搭建node项目" aria-hidden="true">#</a></h2><div class="language-dockerfile"><button title="Copy Code" class="copy"></button><span class="lang">dockerfile</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">version: &#39;2&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">services:</span></span>
<span class="line"><span style="color:#A6ACCD;"> node:</span></span>
<span class="line"><span style="color:#A6ACCD;">  build:</span></span>
<span class="line"><span style="color:#A6ACCD;">    context: ./images/node</span></span>
<span class="line"><span style="color:#A6ACCD;">    dockerfile: Dockerfile</span></span>
<span class="line"><span style="color:#A6ACCD;">  depends_on:</span></span>
<span class="line"><span style="color:#A6ACCD;">   - db</span></span>
<span class="line"><span style="color:#A6ACCD;"> web:</span></span>
<span class="line"><span style="color:#A6ACCD;">  image: nginx</span></span>
<span class="line"><span style="color:#A6ACCD;">  ports:</span></span>
<span class="line"><span style="color:#A6ACCD;">   - &quot;8080:80&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  volumes:</span></span>
<span class="line"><span style="color:#A6ACCD;">   - ./images/nginx/config:/etc/nginx/conf.d</span></span>
<span class="line"><span style="color:#A6ACCD;">   - ./images/node/web/public:/public  </span></span>
<span class="line"><span style="color:#A6ACCD;">  depends_on:</span></span>
<span class="line"><span style="color:#A6ACCD;">   - node</span></span>
<span class="line"><span style="color:#A6ACCD;"> db:</span></span>
<span class="line"><span style="color:#A6ACCD;">  image: mariadb</span></span>
<span class="line"><span style="color:#A6ACCD;">  environment:</span></span>
<span class="line"><span style="color:#A6ACCD;">   MYSQL_ROOT_PASSWORD: &quot;root&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">   MYSQL_DATABASE: &quot;node&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">   MYSQL_USER: &quot;zfpx&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">   MYSQL_PASSWORD: &quot;123456&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  volumes:</span></span>
<span class="line"><span style="color:#A6ACCD;">    - db:/var/lib/mysql</span></span>
<span class="line"><span style="color:#A6ACCD;">volumes:</span></span>
<span class="line"><span style="color:#A6ACCD;"> db:</span></span>
<span class="line"><span style="color:#A6ACCD;">  driver: local</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-c5936a1e data-v-e033cd21><div class="edit-info" data-v-e033cd21><div class="edit-link" data-v-e033cd21><a class="VPLink link edit-link-button" href="https://github.com/wendaobai/wendaobai.github.io/edit/master/docs/前端运维/docker.md" target="_blank" rel="noreferrer" data-v-e033cd21 data-v-30c06bd3><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="edit-link-icon" data-v-e033cd21><path d="M18,23H4c-1.7,0-3-1.3-3-3V6c0-1.7,1.3-3,3-3h7c0.6,0,1,0.4,1,1s-0.4,1-1,1H4C3.4,5,3,5.4,3,6v14c0,0.6,0.4,1,1,1h14c0.6,0,1-0.4,1-1v-7c0-0.6,0.4-1,1-1s1,0.4,1,1v7C21,21.7,19.7,23,18,23z"></path><path d="M8,17c-0.3,0-0.5-0.1-0.7-0.3C7,16.5,6.9,16.1,7,15.8l1-4c0-0.2,0.1-0.3,0.3-0.5l9.5-9.5c1.2-1.2,3.2-1.2,4.4,0c1.2,1.2,1.2,3.2,0,4.4l-9.5,9.5c-0.1,0.1-0.3,0.2-0.5,0.3l-4,1C8.2,17,8.1,17,8,17zM9.9,12.5l-0.5,2.1l2.1-0.5l9.3-9.3c0.4-0.4,0.4-1.1,0-1.6c-0.4-0.4-1.2-0.4-1.6,0l0,0L9.9,12.5z M18.5,2.5L18.5,2.5L18.5,2.5z"></path></svg> 更正错误<!--]--><!----></a></div><!----></div><div class="prev-next" data-v-e033cd21><div class="pager" data-v-e033cd21><a class="pager-link prev" href="/%E5%89%8D%E7%AB%AF%E8%BF%90%E7%BB%B4/CICD.html" data-v-e033cd21><span class="desc" data-v-e033cd21>Previous page</span><span class="title" data-v-e033cd21>CICD</span></a></div><div class="has-prev pager" data-v-e033cd21><a class="pager-link next" href="/%E5%89%8D%E7%AB%AF%E8%BF%90%E7%BB%B4/linux%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4.html" data-v-e033cd21><span class="desc" data-v-e033cd21>Next page</span><span class="title" data-v-e033cd21>linux常见命令</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><footer class="VPFooter has-sidebar" data-v-93a960b4 data-v-d24360a6><div class="container" data-v-d24360a6><p class="message" data-v-d24360a6>MIT Licensed | Copyright © 2021 - 2022</p><p class="copyright" data-v-d24360a6>粤ICP备2021165391号</p></div></footer><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"readme.md\":\"588a9682\",\"index.md\":\"c828e2a8\",\"js_interview_1.实现new实例化对象.md\":\"d9caf8ce\",\"网络_http.md\":\"c976406c\",\"js_interview_2.实现call-apply-bind.md\":\"ff280bd6\",\"js_interview_4.实现继承.md\":\"ef443afb\",\"网络_https.md\":\"c8b5674e\",\"前端运维_docker.md\":\"e371afdf\",\"js_基础_2.作用域.md\":\"9aa8ef31\",\"js_interview_3.实现instanceof.md\":\"df253c67\",\"前端运维_cicd.md\":\"8abdbfa5\",\"js_基础_3.原型链.md\":\"0104212e\",\"网络_tcp.md\":\"95d30144\",\"前端运维_vim.md\":\"eb2e1b3e\",\"js_es6_1.let和const变量声明.md\":\"5b9f830a\",\"前端运维_nginx.md\":\"68c008f8\",\"前端运维_linux常见命令.md\":\"b429cae3\",\"js_es6_5.箭头函数.md\":\"ead3200b\",\"js_基础_1.可执行上下文.md\":\"08159271\",\"js_es6_3.symbol数据类型.md\":\"2d5ec4df\",\"js_es6_2.set与map数据结构.md\":\"f395f0b7\",\"js_es6_4.proxy代理器.md\":\"37a84031\"}")</script>
    <script type="module" async src="/assets/app.1c8695ff.js"></script>
    
  </body>
</html>