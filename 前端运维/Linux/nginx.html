<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>nginx | Create or coding</title>
    <meta name="description" content="A VitePress site">
    <link rel="preload stylesheet" href="/assets/style.ae1251fb.css" as="style">
    <link rel="modulepreload" href="/assets/app.0c9f1ae8.js">
    <link rel="modulepreload" href="/assets/å‰ç«¯è¿ç»´_Linux_nginx.md.2e355d65.lean.js">
    
    <script>var _hmt=_hmt||[];(function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?af110c84612806edd3af36a0678759fb";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-93a960b4><!--[--><!--]--><!--[--><span tabindex="-1" data-v-151f2593></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-151f2593> Skip to content </a><!--]--><!----><header class="VPNav" data-v-93a960b4 data-v-0fa0e57d><div class="VPNavBar has-sidebar" data-v-0fa0e57d data-v-be450ad9><div class="container" data-v-be450ad9><div class="title" data-v-be450ad9><div class="VPNavBarTitle has-sidebar" data-v-be450ad9 data-v-6d2fb2d9><a class="title" href="/" data-v-6d2fb2d9><!--[--><!--]--><!----><!--[-->Code More Create<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-be450ad9><div class="curtain" data-v-be450ad9></div><div class="content-body" data-v-be450ad9><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-be450ad9 data-v-bdedfc22><span id="main-nav-aria-label" class="visually-hidden" data-v-bdedfc22>Main Navigation</span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-bdedfc22 data-v-96001b6b><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-96001b6b><span class="text" data-v-96001b6b><!----> js <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-96001b6b><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-96001b6b><div class="VPMenu" data-v-96001b6b data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-a5bbb52c><a class="VPLink link" href="/js/es6/1.let%E5%92%8Cconst%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E.html" data-v-a5bbb52c data-v-30c06bd3><!--[-->es6<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-a5bbb52c><a class="VPLink link" href="/js/interview/1.%E5%AE%9E%E7%8E%B0new%E5%AE%9E%E4%BE%8B%E5%8C%96%E5%AF%B9%E8%B1%A1.html" data-v-a5bbb52c data-v-30c06bd3><!--[-->interview<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-a5bbb52c><a class="VPLink link" href="/js/%E5%9F%BA%E7%A1%80/1.%E5%8F%AF%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87.html" data-v-a5bbb52c data-v-30c06bd3><!--[-->åŸºç¡€<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-bdedfc22 data-v-96001b6b><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-96001b6b><span class="text" data-v-96001b6b><!----> å‰ç«¯è¿ç»´ <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-96001b6b><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-96001b6b><div class="VPMenu" data-v-96001b6b data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-a5bbb52c><a class="VPLink link" href="/%E5%89%8D%E7%AB%AF%E8%BF%90%E7%BB%B4/Linux/docker.html" data-v-a5bbb52c data-v-30c06bd3><!--[-->Linux<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/README.html" data-v-bdedfc22 data-v-95f5d58b data-v-30c06bd3><!--[-->README<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="https://algorithm.wendaobai.top" target="_blank" rel="noreferrer" data-v-bdedfc22 data-v-95f5d58b data-v-30c06bd3><!--[-->ğŸ„ğŸ»â€â™‚ï¸ ç®—æ³•ç¬”è®°<!--]--><!----></a><!--]--><!--]--></nav><!----><!----><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-be450ad9 data-v-2ab2a029 data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://github.com/wendaobai" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-be450ad9 data-v-66bb1f24 data-v-96001b6b><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-96001b6b><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-96001b6b><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-96001b6b><div class="VPMenu" data-v-96001b6b data-v-e7ea1737><!----><!--[--><!--[--><!----><!----><div class="group" data-v-66bb1f24><div class="item social-links" data-v-66bb1f24><div class="VPSocialLinks social-links-list" data-v-66bb1f24 data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://github.com/wendaobai" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-be450ad9 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav" data-v-93a960b4 data-v-2817d72e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2817d72e><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-2817d72e><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-2817d72e>Menu</span></button><a class="top-link" href="#" data-v-2817d72e>Return to top</a></div><aside class="VPSidebar" data-v-93a960b4 data-v-c79ccefa><div class="curtain" data-v-c79ccefa></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-c79ccefa><span class="visually-hidden" id="sidebar-aria-label" data-v-c79ccefa> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-c79ccefa><section class="VPSidebarItem level-0 collapsible has-active" data-v-c79ccefa data-v-b05232f3><div class="item" role="button" data-v-b05232f3><div class="indicator" data-v-b05232f3></div><a class="VPLink link" data-v-b05232f3 data-v-30c06bd3><!--[--><h2 class="text" data-v-b05232f3>å‰ç«¯è¿ç»´</h2><!--]--><!----></a><div class="caret" role="button" data-v-b05232f3><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-b05232f3><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-b05232f3><!--[--><section class="VPSidebarItem level-1 collapsible has-active" data-v-b05232f3 data-v-b05232f3><div class="item" role="button" data-v-b05232f3><div class="indicator" data-v-b05232f3></div><a class="VPLink link" data-v-b05232f3 data-v-30c06bd3><!--[--><h3 class="text" data-v-b05232f3>Linux</h3><!--]--><!----></a><div class="caret" role="button" data-v-b05232f3><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-b05232f3><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-b05232f3><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b05232f3 data-v-b05232f3><div class="item" data-v-b05232f3><div class="indicator" data-v-b05232f3></div><a class="VPLink link link" href="/%E5%89%8D%E7%AB%AF%E8%BF%90%E7%BB%B4/Linux/docker.html" data-v-b05232f3 data-v-30c06bd3><!--[--><p class="text" data-v-b05232f3>docker</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b05232f3 data-v-b05232f3><div class="item" data-v-b05232f3><div class="indicator" data-v-b05232f3></div><a class="VPLink link link" href="/%E5%89%8D%E7%AB%AF%E8%BF%90%E7%BB%B4/Linux/linux%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4.html" data-v-b05232f3 data-v-30c06bd3><!--[--><p class="text" data-v-b05232f3>linuxå¸¸è§å‘½ä»¤</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link is-active has-active" data-v-b05232f3 data-v-b05232f3><div class="item" data-v-b05232f3><div class="indicator" data-v-b05232f3></div><a class="VPLink link link" href="/%E5%89%8D%E7%AB%AF%E8%BF%90%E7%BB%B4/Linux/nginx.html" data-v-b05232f3 data-v-30c06bd3><!--[--><p class="text" data-v-b05232f3>nginx</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b05232f3 data-v-b05232f3><div class="item" data-v-b05232f3><div class="indicator" data-v-b05232f3></div><a class="VPLink link link" href="/%E5%89%8D%E7%AB%AF%E8%BF%90%E7%BB%B4/Linux/vim.html" data-v-b05232f3 data-v-30c06bd3><!--[--><p class="text" data-v-b05232f3>vim</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-93a960b4 data-v-0bd490fb><div class="VPDoc has-sidebar has-aside" data-v-0bd490fb data-v-c5936a1e><div class="container" data-v-c5936a1e><div class="aside" data-v-c5936a1e><div class="aside-curtain" data-v-c5936a1e></div><div class="aside-container" data-v-c5936a1e><div class="aside-content" data-v-c5936a1e><div class="VPDocAside" data-v-c5936a1e data-v-cdc66372><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-cdc66372 data-v-5dd9d5f6><div class="content" data-v-5dd9d5f6><div class="outline-marker" data-v-5dd9d5f6></div><div class="outline-title" data-v-5dd9d5f6>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-5dd9d5f6><span class="visually-hidden" id="doc-outline-aria-label" data-v-5dd9d5f6> Table of Contents for current page </span><ul class="root" data-v-5dd9d5f6 data-v-1188541a><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-cdc66372></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-c5936a1e><div class="content-container" data-v-c5936a1e><!--[--><!--]--><main class="main" data-v-c5936a1e><div style="position:relative;" class="vp-doc _%E5%89%8D%E7%AB%AF%E8%BF%90%E7%BB%B4_Linux_nginx" data-v-c5936a1e><div><h1 id="nginx" tabindex="-1">nginx <a class="header-anchor" href="#nginx" aria-hidden="true">#</a></h1><h2 id="ä»€ä¹ˆæ˜¯nginx" tabindex="-1">ä»€ä¹ˆæ˜¯Nginx <a class="header-anchor" href="#ä»€ä¹ˆæ˜¯nginx" aria-hidden="true">#</a></h2><ul><li>ä¼˜åŠ¿ <ul><li>é«˜å¹¶å‘ï¼Œé«˜æ–°èƒ½</li><li>æ‰©å±•æ€§å¥½ï¼Œçƒ­éƒ¨ç½²</li><li>å¯é æ€§é«˜ï¼Œå¼€æºè®¸å¯</li></ul></li><li>åº”ç”¨åœºæ™¯ <ul><li>é™æ€èµ„æºæœåŠ¡å™¨</li><li>APiæ¥å£æœåŠ¡</li><li>åå‘ä»£ç†</li></ul></li></ul><img src="/assets/image-20230316144020838.23f22e4c.png" alt="image-20230316144020838" style="zoom:50%;"><h2 id="å®‰è£…" tabindex="-1">å®‰è£… <a class="header-anchor" href="#å®‰è£…" aria-hidden="true">#</a></h2><p>ä¾èµ–æ¨¡å—å®‰è£…</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">-y</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">gcc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">gcc-c++</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">autoconf</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pcre</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">pcre-devel</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">make</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">automake</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">openssl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">openssl-devel</span></span>
<span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-y</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">//å®‰è£…nginx</span></span>
<span class="line"><span style="color:#FFCB6B;">nginx</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-v</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">//æŸ¥çœ‹å®‰è£…çš„ç‰ˆæœ¬</span></span>
<span class="line"><span style="color:#FFCB6B;">nginx</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-V</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">//æŸ¥çœ‹ç¼–è¯‘æ—¶çš„å‚æ•°</span></span>
<span class="line"></span></code></pre></div><h2 id="ç›®å½•åˆ—è¡¨" tabindex="-1">ç›®å½•åˆ—è¡¨ <a class="header-anchor" href="#ç›®å½•åˆ—è¡¨" aria-hidden="true">#</a></h2><p>æŸ¥çœ‹ç›®å½•åˆ—è¡¨</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">rpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-ql</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"></span>
<span class="line"></span></code></pre></div><table><thead><tr><th>æ¨¡å—</th><th>ç›®å½•</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td>é…ç½®ç›®å½•</td><td>/etc/nginx/nginx.conf</td><td>æ ¸å¿ƒé…ç½®æ–‡ä»¶</td></tr><tr><td></td><td>/etc/nginx/conf.d/default.conf</td><td>é»˜è®¤httpæœåŠ¡å™¨é…ç½®æ–‡ä»¶</td></tr><tr><td>æ–‡æ¡£æ‰‹å†Œ</td><td>/usr/share/doc/nginx-1.14.2</td><td>å¸®åŠ©æ–‡æ¡£</td></tr><tr><td></td><td>/usr/share/doc/nginx-1.14.0/COPYRIGHT</td><td>ç‰ˆæƒå£°æ˜</td></tr><tr><td></td><td>/usr/share/man/man8/nginx.8.gz</td><td>æ‰‹å†Œ</td></tr><tr><td>ç¼“å­˜ç›®å½•</td><td>/var/cache/nginx</td><td>nginxçš„ç¼“å­˜ç›®å½•</td></tr><tr><td>æ—¥å¿—ç›®å½•</td><td>/var/log/nginx</td><td>nginxçš„æ—¥å¿—ç›®å½•</td></tr><tr><td>å¯æ‰§è¡Œæ–‡ä»¶</td><td>/usr/sbin/nginx</td><td>å¯æ‰§è¡Œå‘½ä»¤</td></tr><tr><td></td><td>/usr/sbin/nginx-debug</td><td>è°ƒè¯•æ‰§è¡Œå¯æ‰§è¡Œå‘½ä»¤</td></tr><tr><td>æ¨¡å—ç›®å½•</td><td>/etc/nginx/modules</td><td>æœ€åŸºæœ¬çš„å…±äº«åº“å’Œå†…æ ¸æ¨¡å—,</td></tr><tr><td>æ—¥å¿—åˆ‡å‰²</td><td>/etc/logrotate.d/nginx</td><td>å¯¹è®¿é—®æ—¥å¿—è¿›è¡Œåˆ‡å‰²</td></tr><tr><td></td><td></td><td></td></tr></tbody></table><h2 id="é…ç½®" tabindex="-1">é…ç½® <a class="header-anchor" href="#é…ç½®" aria-hidden="true">#</a></h2><ul><li>/etc/nginx/nginx.conf #ä¸»é…ç½®æ–‡ä»¶</li><li>/etc/nginx/conf.d/*.conf #åŒ…å«conf.dç›®å½•ä¸‹é¢çš„æ‰€æœ‰é…ç½®æ–‡ä»¶</li><li>/etc/nginx/conf.d/default.conf</li></ul><h3 id="é…ç½®æ–‡ä»¶è¯­æ³•" tabindex="-1">é…ç½®æ–‡ä»¶è¯­æ³• <a class="header-anchor" href="#é…ç½®æ–‡ä»¶è¯­æ³•" aria-hidden="true">#</a></h3><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;"># ä½¿ç”¨#å¯ä»¥æ·»åŠ æ³¨é‡Š,ä½¿ç”¨$ç¬¦å·å¯ä»¥ä½¿ç”¨å˜é‡</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># é…ç½®æ–‡ä»¶ç”±æŒ‡ä»¤ä¸æŒ‡ä»¤å—ç»„æˆ,æŒ‡ä»¤å—ä»¥{}å°†å¤šæ¡æŒ‡ä»¤ç»„ç»‡åœ¨ä¸€èµ·</span></span>
<span class="line"><span style="color:#C792EA;">http</span><span style="color:#A6ACCD;"> {</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># includeè¯­å¥å…è®¸æŠŠå¤šä¸ªé…ç½®æ–‡ä»¶ç»„åˆèµ·æ¥ä»¥æå‡å¯ç»´æŠ¤æ€§    </span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> include </span><span style="color:#A6ACCD;">      mime.types</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># æ¯æ¡æŒ‡ä»¤ä»¥;(åˆ†å·)ç»“å°¾ï¼ŒæŒ‡ä»¤ä¸å‚æ•°ä¹‹é—´ä»¥ç©ºæ ¼åˆ†éš”</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> default_type </span><span style="color:#A6ACCD;"> application/octet-stream</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> sendfile </span><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;"> on;</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> keepalive_timeout </span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">65</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">server</span><span style="color:#A6ACCD;"> {</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#89DDFF;"> listen </span><span style="color:#A6ACCD;">      </span><span style="color:#F78C6C;">80</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#89DDFF;"> server_name </span><span style="color:#A6ACCD;"> localhost</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># æœ‰äº›æŒ‡ä»¤å¯ä»¥æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼        </span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">/ </span><span style="color:#A6ACCD;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#89DDFF;"> root </span><span style="color:#A6ACCD;">  html</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#89DDFF;"> index </span><span style="color:#A6ACCD;"> index.html index.htm</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        }</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#89DDFF;"> error_page </span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">502</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">503</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">504</span><span style="color:#A6ACCD;">  /50x.html</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/50x.html </span><span style="color:#A6ACCD;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">           </span><span style="color:#89DDFF;"> root </span><span style="color:#A6ACCD;">  html</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        }</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span></code></pre></div><h3 id="å…¨å±€é…ç½®" tabindex="-1">å…¨å±€é…ç½® <a class="header-anchor" href="#å…¨å±€é…ç½®" aria-hidden="true">#</a></h3><table><thead><tr><th style="text-align:left;">åˆ†ç±»</th><th style="text-align:left;">é…ç½®é¡¹</th><th style="text-align:left;">ä½œç”¨</th></tr></thead><tbody><tr><td style="text-align:left;">å…¨å±€</td><td style="text-align:left;">user</td><td style="text-align:left;">è®¾ç½®nginxæœåŠ¡çš„ç³»ç»Ÿä½¿ç”¨ç”¨æˆ·</td></tr><tr><td style="text-align:left;">å…¨å±€</td><td style="text-align:left;">worker_processes</td><td style="text-align:left;">å·¥ä½œè¿›ç¨‹æ•°,ä¸€èˆ¬å’ŒCPUæ•°é‡ç›¸åŒ</td></tr><tr><td style="text-align:left;">å…¨å±€</td><td style="text-align:left;">error_log</td><td style="text-align:left;">nginxçš„é”™è¯¯æ—¥å¿—</td></tr><tr><td style="text-align:left;">å…¨å±€</td><td style="text-align:left;">pid</td><td style="text-align:left;">nginxæœåŠ¡å¯åŠ¨æ—¶çš„pid</td></tr></tbody></table><h3 id="äº‹ä»¶é…ç½®" tabindex="-1">äº‹ä»¶é…ç½® <a class="header-anchor" href="#äº‹ä»¶é…ç½®" aria-hidden="true">#</a></h3><table><thead><tr><th style="text-align:left;">åˆ†ç±»</th><th style="text-align:left;">é…ç½®é¡¹</th><th style="text-align:left;">ä½œç”¨</th></tr></thead><tbody><tr><td style="text-align:left;">events</td><td style="text-align:left;">worker_connections</td><td style="text-align:left;">æ¯ä¸ªè¿›ç¨‹å…è®¸çš„æœ€å¤§è¿æ¥æ•° 10000</td></tr><tr><td style="text-align:left;">events</td><td style="text-align:left;">use</td><td style="text-align:left;">æŒ‡å®šä½¿ç”¨å“ªç§æ¨¡å‹(select/poll/epoll),å»ºè®®è®©nginxè‡ªåŠ¨é€‰æ‹©,linuxå†…æ ¸2.6ä»¥ä¸Šä¸€èˆ¬èƒ½ä½¿ç”¨epollå¯ä»¥æé«˜æ€§èƒ½</td></tr></tbody></table><h3 id="httpé…ç½®" tabindex="-1">httpé…ç½® <a class="header-anchor" href="#httpé…ç½®" aria-hidden="true">#</a></h3><p>ä¸€ä¸ªHTTPä¸‹é¢å¯ä»¥é…ç½®å¤šä¸ªserver</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">#å…¨å±€é…ç½®</span></span>
<span class="line"><span style="color:#89DDFF;">user </span><span style="color:#A6ACCD;"> nginx</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">   </span><span style="color:#676E95;font-style:italic;">#è®¾ç½®nginxæœåŠ¡çš„ç³»ç»Ÿä½¿ç”¨ç”¨æˆ·  </span></span>
<span class="line"><span style="color:#89DDFF;">worker_processes </span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">#å·¥ä½œè¿›ç¨‹æ•°,ä¸€èˆ¬å’ŒCPUæ•°é‡ç›¸åŒ </span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">error_log </span><span style="color:#A6ACCD;"> /var/log/nginx/error.log</span><span style="color:#89DDFF;"> warn;</span><span style="color:#A6ACCD;">   </span><span style="color:#676E95;font-style:italic;">#nginxçš„é”™è¯¯æ—¥å¿—  </span></span>
<span class="line"><span style="color:#89DDFF;">pid </span><span style="color:#A6ACCD;">       /var/run/nginx.pid</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">   </span><span style="color:#676E95;font-style:italic;">#nginxæœåŠ¡å¯åŠ¨æ—¶çš„pid</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#äº‹ä»¶</span></span>
<span class="line"><span style="color:#C792EA;">events</span><span style="color:#A6ACCD;"> {</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> worker_connections </span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1024</span><span style="color:#89DDFF;">;</span><span style="color:#676E95;font-style:italic;">#æ¯ä¸ªè¿›ç¨‹å…è®¸çš„æœ€å¤§è¿æ¥æ•° 10000</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> use </span><span style="color:#A6ACCD;">epoll</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># ä½¿ç”¨è½®è®­æ¨¡å¼</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">http</span><span style="color:#A6ACCD;"> {</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> include </span><span style="color:#A6ACCD;">      /etc/nginx/mime.types</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">#æ–‡ä»¶åç¼€å’Œç±»å‹ç±»å‹çš„å¯¹åº”å…³ç³»</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> default_type </span><span style="color:#A6ACCD;"> application/octet-stream</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># é»˜è®¤content-type</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> log_format  main</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">&#39;</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">remote_addr</span><span style="color:#C3E88D;"> - </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">remote_user</span><span style="color:#C3E88D;"> [</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">time_local</span><span style="color:#C3E88D;">] &quot;</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">request</span><span style="color:#C3E88D;">&quot; &#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">                      </span><span style="color:#C3E88D;">&#39;</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">status</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">body_bytes_sent</span><span style="color:#C3E88D;"> &quot;</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">http_referer</span><span style="color:#C3E88D;">&quot; &#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">                      </span><span style="color:#C3E88D;">&#39;&quot;</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">http_user_agent</span><span style="color:#C3E88D;">&quot; &quot;</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">http_x_forwarded_for</span><span style="color:#C3E88D;">&quot;&#39;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># æ—¥å¿—è®°å½•æ ¼å¼</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> access_log </span><span style="color:#A6ACCD;"> /var/log/nginx/access.log </span><span style="color:#89DDFF;"> main;</span><span style="color:#676E95;font-style:italic;">#é»˜è®¤è®¿é—®æ—¥å¿—</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> sendfile </span><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;"> on;</span><span style="color:#676E95;font-style:italic;"># sendfile</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">#tcp_nopush     on;//æ‡’å‘é€</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> keepalive_timeout </span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">65</span><span style="color:#89DDFF;">;</span><span style="color:#676E95;font-style:italic;">#è¶…æ—¶æ—¶é—´æ˜¯65ç§’</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> gzip  on;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># å¯ç”¨gzipå‹ç¼©</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> include </span><span style="color:#A6ACCD;">/etc/nginx/conf.d/*.conf</span><span style="color:#89DDFF;">;</span><span style="color:#676E95;font-style:italic;">#åŒ…å«çš„å­é…ç½®æ–‡ä»¶</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span></code></pre></div><h3 id="serveré…ç½®" tabindex="-1">serveré…ç½® <a class="header-anchor" href="#serveré…ç½®" aria-hidden="true">#</a></h3><p>ä¸€ä¸ª<code>server</code>ä¸‹é¢å¯ä»¥åŒ…å«å¤šä¸ª<code>location</code></p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">server</span><span style="color:#A6ACCD;"> {</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> listen </span><span style="color:#A6ACCD;">      </span><span style="color:#F78C6C;">80</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">#ç›‘å¬çš„ç«¯å£å·</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> server_name </span><span style="color:#A6ACCD;"> localhost</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">#ç”¨åŸŸåæ–¹å¼è®¿é—®çš„åœ°å€</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">#charset koi8-r; #ç¼–ç </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">#access_log  /var/log/nginx/host.access.log  main;#è®¿é—®æ—¥å¿—æ–‡ä»¶å’Œåç§°</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">/ </span><span style="color:#A6ACCD;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#89DDFF;"> root </span><span style="color:#A6ACCD;">  /usr/share/nginx/html</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">#é™æ€æ–‡ä»¶æ ¹ç›®å½•</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;font-style:italic;"># alias /user/share/nginx/html;#åˆ«åé™æ€æ–‡ä»¶ç›®å½•</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#89DDFF;"> index </span><span style="color:#A6ACCD;"> index.html index.htm</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">#é¦–é¡µçš„ç´¢å¼•æ–‡ä»¶</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">#error_page  404              /404.html;  #æŒ‡å®šé”™è¯¯é¡µé¢</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;"># redirect server error pages to the static page /50x.html</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;"># æŠŠåå°é”™è¯¯é‡å®šå‘åˆ°é™æ€çš„50x.htmlé¡µé¢</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> error_page </span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">502</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">503</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">504</span><span style="color:#A6ACCD;">  /50x.html</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/50x.html </span><span style="color:#A6ACCD;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#89DDFF;"> root </span><span style="color:#A6ACCD;">  /usr/share/nginx/html</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="systemdè¿›ç¨‹ç®¡ç†" tabindex="-1">Systemdè¿›ç¨‹ç®¡ç† <a class="header-anchor" href="#systemdè¿›ç¨‹ç®¡ç†" aria-hidden="true">#</a></h2><ul><li>ç³»ç»Ÿå¯åŠ¨å’ŒæœåŠ¡å™¨å®ˆæŠ¤è¿›ç¨‹ç®¡ç†å™¨ï¼Œè´Ÿè´£åœ¨ç³»ç»Ÿå¯åŠ¨æˆ–è¿è¡Œæ—¶ï¼Œæ¿€æ´»ç³»ç»Ÿèµ„æºï¼ŒæœåŠ¡å™¨è¿›ç¨‹å’Œå…¶ä»–è¿›ç¨‹ï¼Œæ ¹æ®ç®¡ç†ï¼Œå­—æ¯dæ˜¯å®ˆæŠ¤è¿›ç¨‹ï¼ˆdaemonï¼‰çš„ç¼©å†™</li></ul><h4 id="systemctl" tabindex="-1">systemctl <a class="header-anchor" href="#systemctl" aria-hidden="true">#</a></h4><ul><li>ç›‘è§†å’Œæ§åˆ¶systemdçš„ä¸»è¦å‘½ä»¤æ˜¯systemctl</li><li>è¯¥å‘½ä»¤å¯ç”¨äºæŸ¥çœ‹ç³»ç»ŸçŠ¶æ€å’Œç®¡ç†ç³»ç»ŸåŠæœåŠ¡</li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">å‘½ä»¤ï¼šsystemctl  command name</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">service</span></span>
<span class="line"><span style="color:#A6ACCD;">å¯åŠ¨ï¼šservice name start â€“</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">systemctl start name</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">service</span></span>
<span class="line"><span style="color:#A6ACCD;">åœæ­¢ï¼šservice name stop â€“</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">systemctl stop name</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">service</span></span>
<span class="line"><span style="color:#A6ACCD;">é‡å¯ï¼šservice name restartâ€“</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">systemctl restart name</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">service</span></span>
<span class="line"><span style="color:#A6ACCD;">çŠ¶æ€ï¼šservice name statusâ€“</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">systemctl status name</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">service</span></span>
<span class="line"></span></code></pre></div><h4 id="å¯åŠ¨å’Œé‡æ–°åŠ è½½" tabindex="-1">å¯åŠ¨å’Œé‡æ–°åŠ è½½ <a class="header-anchor" href="#å¯åŠ¨å’Œé‡æ–°åŠ è½½" aria-hidden="true">#</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">systemctl restart nginx</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">service</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl reload nginx</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">service</span></span>
<span class="line"><span style="color:#A6ACCD;">nginx </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">s reload</span></span>
<span class="line"></span></code></pre></div><h2 id="nginxæ—¥å¿—" tabindex="-1">nginxæ—¥å¿— <a class="header-anchor" href="#nginxæ—¥å¿—" aria-hidden="true">#</a></h2><h2 id="nginxå·¥ä½œæµ" tabindex="-1">nginxå·¥ä½œæµ <a class="header-anchor" href="#nginxå·¥ä½œæµ" aria-hidden="true">#</a></h2><ul><li>è¯·æ±‚åˆ°æ¥æ—¶å…ˆæŒ‰åŸŸåæ‰¾åˆ°<code>server</code>å—</li><li>å†æŒ‰è¯·æ±‚è·¯å¾„æ‰¾åˆ°<code>location</code>å—</li><li><code>Context</code>æ˜¯æŒ‡æœ¬æŒ‡ä»¤å‡ºç°åœ¨å“ªä¸ªå—å†…</li></ul><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">main</span></span>
<span class="line"><span style="color:#A6ACCD;">http</span><span style="color:#F07178;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">upstream</span><span style="color:#F07178;"> {}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">server</span><span style="color:#F07178;"> {</span></span>
<span class="line"><span style="color:#F07178;">        if(){}</span></span>
<span class="line"><span style="color:#F07178;">        location{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">        }</span></span>
<span class="line"><span style="color:#F07178;">        location{</span></span>
<span class="line"><span style="color:#F07178;">            location{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">            }</span></span>
<span class="line"><span style="color:#F07178;">        }</span></span>
<span class="line"><span style="color:#F07178;">    }</span></span>
<span class="line"><span style="color:#F07178;">    server{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    }</span></span>
<span class="line"><span style="color:#F07178;">}</span></span>
<span class="line"></span></code></pre></div><h4 id="serveråŒ¹é…" tabindex="-1">serveråŒ¹é… <a class="header-anchor" href="#serveråŒ¹é…" aria-hidden="true">#</a></h4><h4 id="httpå¤„ç†æµç¨‹" tabindex="-1">httpå¤„ç†æµç¨‹ <a class="header-anchor" href="#httpå¤„ç†æµç¨‹" aria-hidden="true">#</a></h4><table><thead><tr><th style="text-align:left;">é˜¶æ®µ</th><th style="text-align:left;">åç§°</th><th style="text-align:left;">å¯¹åº”æ¨¡å—</th></tr></thead><tbody><tr><td style="text-align:left;">è¯»å–è¯·æ±‚å</td><td style="text-align:left;">POST_READ</td><td style="text-align:left;">realip</td></tr><tr><td style="text-align:left;">é‡å†™</td><td style="text-align:left;">SERVER_REWRITE</td><td style="text-align:left;">rewrite</td></tr><tr><td style="text-align:left;">åŒ¹é…location</td><td style="text-align:left;">FIND_CONFIG</td><td style="text-align:left;">rewrite</td></tr><tr><td style="text-align:left;">é‡å†™</td><td style="text-align:left;">REWRITE</td><td style="text-align:left;">rewrite</td></tr><tr><td style="text-align:left;">é‡å†™å</td><td style="text-align:left;">POST_REWRITE</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">è®¿é—®å‰é™åˆ¶</td><td style="text-align:left;">PREACCESS</td><td style="text-align:left;">limit_conn,limit_req</td></tr><tr><td style="text-align:left;">æ˜¯å¦æœ‰æƒé™è®¿é—®</td><td style="text-align:left;">ACCESS</td><td style="text-align:left;">auth_basic,access,auth_request</td></tr><tr><td style="text-align:left;">åˆ¤æ–­æƒé™å</td><td style="text-align:left;">POST_ACCESS</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">å“åº”å‰</td><td style="text-align:left;">PRECONTENT</td><td style="text-align:left;">try_files</td></tr><tr><td style="text-align:left;">è¯»å–è¯·æ±‚å</td><td style="text-align:left;">CONTENT</td><td style="text-align:left;">index,autoindex,concat</td></tr><tr><td style="text-align:left;">æ‰“å°æ—¥å¿—</td><td style="text-align:left;">LOG</td><td style="text-align:left;">access_log</td></tr></tbody></table><img src="/assets/image-20230317104438268.68231c8a.png" alt="image-20230317104438268" style="zoom:50%;"><h2 id="æ ¸å¿ƒåŠŸèƒ½" tabindex="-1">æ ¸å¿ƒåŠŸèƒ½ <a class="header-anchor" href="#æ ¸å¿ƒåŠŸèƒ½" aria-hidden="true">#</a></h2><h3 id="ç›‘æ§å®¢æˆ·ç«¯çŠ¶æ€" tabindex="-1">ç›‘æ§å®¢æˆ·ç«¯çŠ¶æ€ <a class="header-anchor" href="#ç›‘æ§å®¢æˆ·ç«¯çŠ¶æ€" aria-hidden="true">#</a></h3><p>systemctl reload nginx.service</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">server</span><span style="color:#A6ACCD;"> {</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">/status</span><span style="color:#A6ACCD;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">stub_status</span><span style="color:#A6ACCD;">   on</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">systemctl reload nginx.service</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">http://192.171.207.104/status</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">Active connections: 2            </span></span>
<span class="line"><span style="color:#A6ACCD;">server accepts handled requests  </span></span>
<span class="line"><span style="color:#A6ACCD;"> 3 3 10 </span></span>
<span class="line"><span style="color:#A6ACCD;">Reading: 0 Writing: 1 Waiting: 1 </span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><table><thead><tr><th style="text-align:left;">å‚æ•°</th><th style="text-align:left;">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:left;">Active connections</td><td style="text-align:left;">å½“å‰nginxæ­£åœ¨å¤„ç†çš„æ´»åŠ¨è¿æ¥æ•°</td></tr><tr><td style="text-align:left;">accepts</td><td style="text-align:left;">æ€»å…±å¤„ç†çš„è¿æ¥æ•°</td></tr><tr><td style="text-align:left;">handled</td><td style="text-align:left;">æˆåŠŸåˆ›å»ºæ¡æ‰‹æ•°</td></tr><tr><td style="text-align:left;">requests</td><td style="text-align:left;">æ€»å…±å¤„ç†è¯·æ±‚æ•°</td></tr><tr><td style="text-align:left;">Reading</td><td style="text-align:left;">è¯»å–åˆ°å®¢æˆ·ç«¯çš„Headerä¿¡æ¯æ•°</td></tr><tr><td style="text-align:left;">Writing</td><td style="text-align:left;">è¿”å›ç»™å®¢æˆ·ç«¯çš„Headerä¿¡æ¯æ•°</td></tr><tr><td style="text-align:left;">Waiting</td><td style="text-align:left;">å¼€å¯keep-aliveçš„æƒ…å†µä¸‹,è¿™ä¸ªå€¼ç­‰äº active â€“ (reading + writing)</td></tr></tbody></table><h3 id="éšæœºè®¿é—®ä¸»é¡µ" tabindex="-1">éšæœºè®¿é—®ä¸»é¡µ <a class="header-anchor" href="#éšæœºè®¿é—®ä¸»é¡µ" aria-hidden="true">#</a></h3><p>--with-http_random_index_module åœ¨æ ¹ç›®å½•é‡Œéšæœºé€‰æ‹©ä¸€ä¸ªä¸»é¡µæ˜¾ç¤º</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">/ </span><span style="color:#A6ACCD;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">     </span><span style="color:#89DDFF;"> root </span><span style="color:#A6ACCD;">/opt/app</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">     </span><span style="color:#89DDFF;"> random_index </span><span style="color:#A6ACCD;">on</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">   </span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">mkdir</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/opt/app</span></span>
<span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/opt/app</span></span>
<span class="line"><span style="color:#FFCB6B;">ls</span></span>
<span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">red</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">read.html</span></span>
<span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">yellow</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">yellow.html</span></span>
<span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">blue</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">blue.html</span></span>
<span class="line"></span></code></pre></div><h3 id="å†…å®¹æ›¿æ¢" tabindex="-1">å†…å®¹æ›¿æ¢ <a class="header-anchor" href="#å†…å®¹æ›¿æ¢" aria-hidden="true">#</a></h3><p>--with-http_sub_module å†…å®¹æ›¿æ¢</p><h2 id="å¸¸è§åº”ç”¨" tabindex="-1">å¸¸è§åº”ç”¨ <a class="header-anchor" href="#å¸¸è§åº”ç”¨" aria-hidden="true">#</a></h2><h2 id="é™æ€webæœåŠ¡å™¨" tabindex="-1">é™æ€webæœåŠ¡å™¨ <a class="header-anchor" href="#é™æ€webæœåŠ¡å™¨" aria-hidden="true">#</a></h2><h3 id="é™æ€æœåŠ¡ä¸åŠ¨æ€æœåŠ¡" tabindex="-1">é™æ€æœåŠ¡ä¸åŠ¨æ€æœåŠ¡ <a class="header-anchor" href="#é™æ€æœåŠ¡ä¸åŠ¨æ€æœåŠ¡" aria-hidden="true">#</a></h3><ul><li>é™æ€èµ„æºï¼šä¸€èˆ¬å®¢æˆ·ç«¯å‘é€è¯·æ±‚åˆ°webæœåŠ¡å™¨ï¼ŒwebæœåŠ¡å™¨ä»å†…å­˜åœ¨å–åˆ°ç›¸åº”çš„æ–‡ä»¶ï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯è§£æå¹¶æ¸²æŸ“æ˜¾ç¤ºå‡ºæ¥ã€‚</li><li>åŠ¨æ€èµ„æºï¼šä¸€èˆ¬å®¢æˆ·ç«¯è¯·æ±‚çš„åŠ¨æ€èµ„æºï¼Œå…ˆå°†è¯·æ±‚äº¤äºwebå®¹å™¨ï¼Œwebå®¹å™¨è¿æ¥æ•°æ®åº“ï¼Œæ•°æ®åº“å¤„ç†æ•°æ®ä¹‹åï¼Œå°†å†…å®¹äº¤ç»™webæœåŠ¡å™¨ï¼ŒwebæœåŠ¡å™¨è¿”å›ç»™å®¢æˆ·ç«¯è§£ææ¸²æŸ“å¤„ç†ã€‚</li></ul><h3 id="cdn" tabindex="-1">CDN <a class="header-anchor" href="#cdn" aria-hidden="true">#</a></h3><ul><li><p>CDNçš„å…¨ç§°æ˜¯Content Delivery Networkï¼Œå³å†…å®¹åˆ†å‘ç½‘ç»œã€‚</p></li><li><p>CDNç³»ç»Ÿèƒ½å¤Ÿå®æ—¶åœ°æ ¹æ®ç½‘ç»œæµé‡å’Œå„èŠ‚ç‚¹çš„è¿æ¥ã€è´Ÿè½½çŠ¶å†µä»¥åŠåˆ°ç”¨æˆ·çš„è·ç¦»å’Œå“åº”æ—¶é—´ç­‰ç»¼åˆä¿¡æ¯å°†ç”¨æˆ·çš„è¯·æ±‚é‡æ–°å¯¼å‘ç¦»ç”¨æˆ·æœ€è¿‘çš„æœåŠ¡èŠ‚ç‚¹ä¸Šã€‚å…¶ç›®çš„æ˜¯ä½¿ç”¨æˆ·å¯å°±è¿‘å–å¾—æ‰€éœ€å†…å®¹ï¼Œè§£å†³ Internetç½‘ç»œæ‹¥æŒ¤çš„çŠ¶å†µï¼Œæé«˜ç”¨æˆ·è®¿é—®ç½‘ç«™çš„å“åº”é€Ÿåº¦ã€‚</p></li><li><p>DNçš„å…¨ç§°æ˜¯Content Delivery Networkï¼Œå³å†…å®¹åˆ†å‘ç½‘ç»œã€‚</p></li><li><p>CDNç³»ç»Ÿèƒ½å¤Ÿå®æ—¶åœ°æ ¹æ®ç½‘ç»œæµé‡å’Œå„èŠ‚ç‚¹çš„è¿æ¥ã€è´Ÿè½½çŠ¶å†µä»¥åŠåˆ°ç”¨æˆ·çš„è·ç¦»å’Œå“åº”æ—¶é—´ç­‰ç»¼åˆä¿¡æ¯å°†ç”¨æˆ·çš„è¯·æ±‚é‡æ–°å¯¼å‘ç¦»ç”¨æˆ·æœ€è¿‘çš„æœåŠ¡èŠ‚ç‚¹ä¸Šã€‚å…¶ç›®çš„æ˜¯ä½¿ç”¨æˆ·å¯å°±è¿‘å–å¾—æ‰€éœ€å†…å®¹ï¼Œè§£å†³ Internetç½‘ç»œæ‹¥æŒ¤çš„çŠ¶å†µï¼Œæé«˜ç”¨æˆ·è®¿é—®ç½‘ç«™çš„å“åº”é€Ÿåº¦ã€‚</p></li></ul><p><a href="http://img.zhufengpeixun.cn/cdn.jpg" target="_blank" rel="noreferrer">cdn</a></p><h3 id="é…ç½®è¯­æ³•" tabindex="-1">é…ç½®è¯­æ³• <a class="header-anchor" href="#é…ç½®è¯­æ³•" aria-hidden="true">#</a></h3><h4 id="_1-sendfile" tabindex="-1">1 sendfile <a class="header-anchor" href="#_1-sendfile" aria-hidden="true">#</a></h4><ul><li>ä¸ç»è¿‡ç”¨æˆ·å†…æ ¸å‘é€æ–‡ä»¶</li></ul><table><thead><tr><th style="text-align:left;">ç±»å‹</th><th style="text-align:left;">ç§ç±»</th></tr></thead><tbody><tr><td style="text-align:left;">è¯­æ³•</td><td style="text-align:left;">sendfile on / off</td></tr><tr><td style="text-align:left;">é»˜è®¤</td><td style="text-align:left;">sendfile off;</td></tr><tr><td style="text-align:left;">ä¸Šä¸‹æ–‡</td><td style="text-align:left;">http,server,location,if in location</td></tr></tbody></table><h4 id="_2-tcp-nopush" tabindex="-1">2 tcp_nopush <a class="header-anchor" href="#_2-tcp-nopush" aria-hidden="true">#</a></h4><ul><li>åœ¨sendfileå¼€å¯çš„æƒ…å†µä¸‹ï¼Œåˆå¹¶å¤šä¸ªæ•°æ®åŒ…ï¼Œæé«˜ç½‘ç»œåŒ…çš„ä¼ è¾“æ•ˆç‡</li></ul><table><thead><tr><th style="text-align:left;">ç±»å‹</th><th style="text-align:left;">ç§ç±»</th></tr></thead><tbody><tr><td style="text-align:left;">è¯­æ³•</td><td style="text-align:left;">tcp_nopush on / off</td></tr><tr><td style="text-align:left;">é»˜è®¤</td><td style="text-align:left;">tcp_nopush off;</td></tr><tr><td style="text-align:left;">ä¸Šä¸‹æ–‡</td><td style="text-align:left;">http,server,location</td></tr></tbody></table><h4 id="_3-tcp-nodelay" tabindex="-1">3 tcp_nodelay <a class="header-anchor" href="#_3-tcp-nodelay" aria-hidden="true">#</a></h4><ul><li>åœ¨keepaliveè¿æ¥ä¸‹ï¼Œæé«˜ç½‘ç»œåŒ…çš„ä¼ è¾“å®æ—¶æ€§</li></ul><table><thead><tr><th style="text-align:left;">ç±»å‹</th><th style="text-align:left;">ç§ç±»</th></tr></thead><tbody><tr><td style="text-align:left;">è¯­æ³•</td><td style="text-align:left;">tcp_nodelay on / off</td></tr><tr><td style="text-align:left;">é»˜è®¤</td><td style="text-align:left;">tcp_nodelay on;</td></tr><tr><td style="text-align:left;">ä¸Šä¸‹æ–‡</td><td style="text-align:left;">http,server,location</td></tr></tbody></table><h4 id="_4-gzip" tabindex="-1">4 gzip <a class="header-anchor" href="#_4-gzip" aria-hidden="true">#</a></h4><ul><li>å‹ç¼©æ–‡ä»¶å¯ä»¥èŠ‚çº¦å¸¦å®½å’Œæé«˜ç½‘ç»œä¼ è¾“æ•ˆç‡</li></ul><table><thead><tr><th style="text-align:left;">ç±»å‹</th><th style="text-align:left;">ç§ç±»</th></tr></thead><tbody><tr><td style="text-align:left;">è¯­æ³•</td><td style="text-align:left;">gzip on / off</td></tr><tr><td style="text-align:left;">é»˜è®¤</td><td style="text-align:left;">gzip off;</td></tr><tr><td style="text-align:left;">ä¸Šä¸‹æ–‡</td><td style="text-align:left;">http,server,location</td></tr></tbody></table><h4 id="_5-gzip-comp-level" tabindex="-1">5 gzip_comp_level <a class="header-anchor" href="#_5-gzip-comp-level" aria-hidden="true">#</a></h4><ul><li>å‹ç¼©æ¯”ç‡è¶Šé«˜ï¼Œæ–‡ä»¶è¢«å‹ç¼©çš„ä½“ç§¯è¶Šå°</li></ul><table><thead><tr><th style="text-align:left;">ç±»å‹</th><th style="text-align:left;">ç§ç±»</th></tr></thead><tbody><tr><td style="text-align:left;">è¯­æ³•</td><td style="text-align:left;">gzip_comp_level level</td></tr><tr><td style="text-align:left;">é»˜è®¤</td><td style="text-align:left;">gzip_comp_level 1;</td></tr><tr><td style="text-align:left;">ä¸Šä¸‹æ–‡</td><td style="text-align:left;">http,server,location</td></tr></tbody></table><h4 id="_6-gzip-http-version" tabindex="-1">6 gzip_http_version <a class="header-anchor" href="#_6-gzip-http-version" aria-hidden="true">#</a></h4><ul><li>å‹ç¼©ç‰ˆæœ¬</li></ul><table><thead><tr><th style="text-align:left;">ç±»å‹</th><th style="text-align:left;">ç§ç±»</th></tr></thead><tbody><tr><td style="text-align:left;">è¯­æ³•</td><td style="text-align:left;">gzip_http_version 1.0/1.1</td></tr><tr><td style="text-align:left;">é»˜è®¤</td><td style="text-align:left;">gzip_http_version 1.1;</td></tr><tr><td style="text-align:left;">ä¸Šä¸‹æ–‡</td><td style="text-align:left;">http,server,location</td></tr></tbody></table><h4 id="_7-http-gzip-static-module" tabindex="-1">7 http_gzip-static_module <a class="header-anchor" href="#_7-http-gzip-static-module" aria-hidden="true">#</a></h4><ul><li>å…ˆæ‰¾ç£ç›˜ä¸Šæ‰¾åŒåçš„<code>.gz</code>è¿™ä¸ªæ–‡ä»¶æ˜¯å¦å­˜åœ¨,èŠ‚çº¦CPUçš„å‹ç¼©æ—¶é—´å’Œæ€§èƒ½æŸè€—</li><li><code>http_gzip_static_module</code> é¢„è®¡gzipæ¨¡å—</li><li><code>http_gunzip_module</code> åº”ç”¨æ”¯æŒgunzipçš„å‹ç¼©æ–¹å¼</li></ul><table><thead><tr><th style="text-align:left;">ç±»å‹</th><th style="text-align:left;">ç§ç±»</th></tr></thead><tbody><tr><td style="text-align:left;">è¯­æ³•</td><td style="text-align:left;">gzip_static on/off</td></tr><tr><td style="text-align:left;">é»˜è®¤</td><td style="text-align:left;">gzip_static off;</td></tr><tr><td style="text-align:left;">ä¸Šä¸‹æ–‡</td><td style="text-align:left;">http,server,location</td></tr></tbody></table><h2 id="nginxç¼“å­˜" tabindex="-1">nginxç¼“å­˜ <a class="header-anchor" href="#nginxç¼“å­˜" aria-hidden="true">#</a></h2><h3 id="å®¢æˆ·ç«¯ç¼“å­˜" tabindex="-1">å®¢æˆ·ç«¯ç¼“å­˜ <a class="header-anchor" href="#å®¢æˆ·ç«¯ç¼“å­˜" aria-hidden="true">#</a></h3><ul><li>ä¼˜å…ˆæ ¡éªŒå¼ºç¼“å­˜expires(åˆ†é’Ÿ) cache-control(max-ageç§’çº§åˆ«)ï¼Œcache-controlä¼˜å…ˆçº§å¤§äºexpires</li><li>ç„¶åæ ¡éªŒåå•†ç¼“å­˜last-modified etagå­—æ®µ,eTagæŒ‡çº¹æ•ˆæœæ¯”last-modifiedå¥½</li></ul><img src="/assets/image-20230321105409718.049ed495.png" alt="image-20230321105409718" style="zoom:50%;"><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.*\.(js|css)$ </span><span style="color:#A6ACCD;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> expires </span><span style="color:#A6ACCD;">10d</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">	add_header </span><span style="color:#A6ACCD;">   Cache-Control  max-age=3600</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">}   </span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><h2 id="è·¨åŸŸè®¾ç½®" tabindex="-1">è·¨åŸŸè®¾ç½® <a class="header-anchor" href="#è·¨åŸŸè®¾ç½®" aria-hidden="true">#</a></h2><ul><li>è·¨åŸŸæ˜¯æŒ‡ä¸€ä¸ªåŸŸä¸‹çš„æ–‡æ¡£æˆ–è„šæœ¬è¯•å›¾å»è¯·æ±‚å¦ä¸€ä¸ªåŸŸä¸‹çš„èµ„æº</li></ul><table><thead><tr><th style="text-align:left;">ç±»å‹</th><th style="text-align:left;">ç§ç±»</th></tr></thead><tbody><tr><td style="text-align:left;">è¯­æ³•</td><td style="text-align:left;">add_header name value</td></tr><tr><td style="text-align:left;">é»˜è®¤</td><td style="text-align:left;">add_header --;</td></tr><tr><td style="text-align:left;">ä¸Šä¸‹æ–‡</td><td style="text-align:left;">http,server,location</td></tr></tbody></table><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">mkdir</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/data/json</span></span>
<span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/data/json</span></span>
<span class="line"><span style="color:#FFCB6B;">vi</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">user.json</span></span>
<span class="line"><span style="color:#89DDFF;">{</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">zs</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#FFCB6B;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">~</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.</span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;">\.</span><span style="color:#C3E88D;">json</span><span style="color:#A6ACCD;">$ </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">     </span><span style="color:#FFCB6B;">add_header</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Access-Control-Allow-Origin</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">http://127.0.0.1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">     </span><span style="color:#FFCB6B;">add_header</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Access-Control-Allow-Methods</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">GET,POST,PUT,DELETE,OPTIONS</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">     </span><span style="color:#FFCB6B;">root</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/data/json</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span></code></pre></div><p>index.html</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">&lt;!</span><span style="color:#F07178;">DOCTYPE</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">HTML</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">PUBLIC</span><span style="color:#89DDFF;"> </span><span style="color:#C3E88D;">&quot;-//W3C//DTD HTML 4.0 Transitional//EN&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">html</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">head</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">head</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">body</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> xhr </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">XMLHttpRequest</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    xhr</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">open</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">GET</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">http://115.29.148.6/user.json</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    xhr</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">onreadystatechange</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">xhr</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">readyState</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">==</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">4</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">xhr</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">status</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">==</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">200</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">xhr</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">responseText</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">xhr</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">body</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">html</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><h2 id="ä»£ç†æœåŠ¡" tabindex="-1">ä»£ç†æœåŠ¡ <a class="header-anchor" href="#ä»£ç†æœåŠ¡" aria-hidden="true">#</a></h2><p>ç›¸å…³é…ç½®</p><table><thead><tr><th style="text-align:left;">ç±»å‹</th><th style="text-align:left;">ç§ç±»</th></tr></thead><tbody><tr><td style="text-align:left;">è¯­æ³•</td><td style="text-align:left;">proxy_pass URL</td></tr><tr><td style="text-align:left;">é»˜è®¤</td><td style="text-align:left;">-</td></tr><tr><td style="text-align:left;">ä¸Šä¸‹æ–‡</td><td style="text-align:left;">server,location</td></tr></tbody></table><h3 id="æ­£å‘ä»£ç†" tabindex="-1">æ­£å‘ä»£ç† <a class="header-anchor" href="#æ­£å‘ä»£ç†" aria-hidden="true">#</a></h3><ul><li>æ­£å‘ä»£ç†çš„å¯¹è±¡æ˜¯å®¢æˆ·ç«¯,æœåŠ¡å™¨ç«¯çœ‹ä¸åˆ°çœŸæ­£çš„å®¢æˆ·ç«¯</li><li>é€šè¿‡å…¬å¸ä»£ç†æœåŠ¡å™¨ä¸Šç½‘</li></ul><img src="/assets/image-20230321152631863.6282010b.png" alt="image-20230321152631863" style="zoom:50%;"><h3 id="æ–¹å‘ä»£ç†" tabindex="-1">æ–¹å‘ä»£ç† <a class="header-anchor" href="#æ–¹å‘ä»£ç†" aria-hidden="true">#</a></h3><ul><li>åå‘ä»£ç†çš„å¯¹è±¡çš„æœåŠ¡ç«¯,å®¢æˆ·ç«¯çœ‹ä¸åˆ°çœŸæ­£çš„æœåŠ¡ç«¯</li><li>nginxä»£ç†åº”ç”¨æœåŠ¡å™¨</li></ul><img src="/assets/image-20230321152718028.34dd8ab4.png" alt="image-20230321152718028" style="zoom:50%;"><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">^/api </span><span style="color:#A6ACCD;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> proxy_pass </span><span style="color:#A6ACCD;">http://localhost:3000</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> proxy_redirect </span><span style="color:#A6ACCD;">default</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">#é‡å®šå‘</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> proxy_set_header </span><span style="color:#A6ACCD;">Host </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">http_host</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">        </span><span style="color:#676E95;font-style:italic;">#å‘åä¼ é€’å¤´ä¿¡æ¯</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> proxy_set_header </span><span style="color:#A6ACCD;">X-Real-IP </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">remote_addr</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">#æŠŠçœŸå®IPä¼ ç»™åº”ç”¨æœåŠ¡å™¨</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> proxy_connect_timeout </span><span style="color:#A6ACCD;">30</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">#é»˜è®¤è¶…æ—¶æ—¶é—´</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> proxy_send_timeout </span><span style="color:#A6ACCD;">60</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;"># å‘é€è¶…æ—¶</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> proxy_read_timeout </span><span style="color:#A6ACCD;">60</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;"># è¯»å–è¶…æ—¶</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> proxy_buffering </span><span style="color:#A6ACCD;">on</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">             </span><span style="color:#676E95;font-style:italic;"># åœ¨proxy_buffering å¼€å¯çš„æƒ…å†µä¸‹ï¼ŒNginxå°†ä¼šå°½å¯èƒ½çš„è¯»å–æ‰€æœ‰çš„upstreamç«¯ä¼ è¾“çš„æ•°æ®åˆ°bufferï¼Œç›´åˆ°proxy_buffersè®¾ç½®çš„æ‰€æœ‰bufferä»¬ è¢«å†™æ»¡æˆ–è€…æ•°æ®è¢«è¯»å–å®Œ(EOF)</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> proxy_buffers </span><span style="color:#A6ACCD;">4 </span><span style="color:#F78C6C;">128k</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">           </span><span style="color:#676E95;font-style:italic;"># proxy_buffersç”±ç¼“å†²åŒºæ•°é‡å’Œç¼“å†²åŒºå¤§å°ç»„æˆçš„ã€‚æ€»çš„å¤§å°ä¸ºnumber*size</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> proxy_busy_buffers_size </span><span style="color:#A6ACCD;">256k</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">   </span><span style="color:#676E95;font-style:italic;"># proxy_busy_buffers_sizeä¸æ˜¯ç‹¬ç«‹çš„ç©ºé—´ï¼Œä»–æ˜¯proxy_bufferså’Œproxy_buffer_sizeçš„ä¸€éƒ¨åˆ†ã€‚nginxä¼šåœ¨æ²¡æœ‰å®Œå…¨è¯»å®Œåç«¯å“åº”çš„æ—¶å€™å°±å¼€å§‹å‘å®¢æˆ·ç«¯ä¼ é€æ•°æ®ï¼Œæ‰€ä»¥å®ƒä¼šåˆ’å‡ºä¸€éƒ¨åˆ†ç¼“å†²åŒºæ¥ä¸“é—¨å‘å®¢æˆ·ç«¯ä¼ é€æ•°æ®(è¿™éƒ¨åˆ†çš„å¤§å°æ˜¯ç”±proxy_busy_buffers_sizeæ¥æ§åˆ¶çš„ï¼Œå»ºè®®ä¸ºproxy_buffersä¸­å•ä¸ªç¼“å†²åŒºå¤§å°çš„2å€)ï¼Œç„¶åå®ƒç»§ç»­ä»åç«¯å–æ•°æ®ï¼Œç¼“å†²åŒºæ»¡äº†ä¹‹åå°±å†™åˆ°ç£ç›˜çš„ä¸´æ—¶æ–‡ä»¶ä¸­ã€‚</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> proxy_buffer_size </span><span style="color:#A6ACCD;">32k</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">          </span><span style="color:#676E95;font-style:italic;"># ç”¨æ¥å­˜å‚¨upstreamç«¯responseçš„header</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;"> proxy_max_temp_file_size </span><span style="color:#A6ACCD;">256k</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># responseçš„å†…å®¹å¾ˆå¤§çš„ è¯ï¼ŒNginxä¼šæ¥æ”¶å¹¶æŠŠä»–ä»¬å†™å…¥åˆ°temp_fileé‡Œå»ï¼Œå¤§å°ç”±proxy_max_temp_file_sizeæ§åˆ¶ã€‚å¦‚æœbusyçš„buffer ä¼ è¾“å®Œäº†ä¼šä»temp_fileé‡Œé¢æ¥ç€è¯»æ•°æ®ï¼Œç›´åˆ°ä¼ è¾“å®Œæ¯•ã€‚</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">curl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">http://localhost/api/users.json</span></span>
<span class="line"></span></code></pre></div><h3 id="proxy-pass" tabindex="-1">proxy_pass <a class="header-anchor" href="#proxy-pass" aria-hidden="true">#</a></h3><ul><li>å¦‚æœ<code>proxy_pass</code>çš„<code>URL</code>å®šå‘é‡Œä¸åŒ…æ‹¬<code>URI</code>ï¼Œé‚£ä¹ˆè¯·æ±‚ä¸­çš„URIä¼šä¿æŒåŸæ ·ä¼ é€ç»™åç«¯server</li><li>ä¸ºäº†æ–¹ä¾¿è®°å¿†å’Œè§„èŒƒé…ç½®ï¼Œå»ºè®®æ‰€æœ‰çš„ proxy_pass åçš„urléƒ½ä»¥<code>/</code>ç»“å°¾</li><li><code>proxy_pass</code>åçš„urlæœ€ååŠ ä¸Š<code>/</code>å°±æ˜¯ç»å¯¹æ ¹è·¯å¾„ï¼Œ<code>location</code>ä¸­åŒ¹é…çš„è·¯å¾„éƒ¨åˆ†ä¸èµ°ä»£ç†,ä¹Ÿå°±æ˜¯è¯´ä¼šè¢«æ›¿æ¢æ‰</li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">location </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">a</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">proxy_pass</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">http</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//127.0.0.1/b/;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#FFCB6B;">è¯·æ±‚http</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//example.com/a/test.html ä¼šè¢«ä»£ç†åˆ°http://127.0.0.1/b/test.html</span></span>
<span class="line"></span></code></pre></div><ul><li>å¦‚æœ<code>proxy_pass</code>çš„<code>URL</code>å®šå‘é‡Œä¸åŒ…æ‹¬<code>URI</code>ï¼Œé‚£ä¹ˆè¯·æ±‚ä¸­çš„URIä¼šä¿æŒåŸæ ·ä¼ é€ç»™åç«¯server,å¦‚æœæ²¡æœ‰/ï¼Œè¡¨ç¤ºç›¸å¯¹è·¯å¾„</li><li><code>proxy_pass</code>åçš„urlæœ€åæ²¡æœ‰<code>/</code>å°±æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œ<code>location</code>ä¸­åŒ¹é…çš„è·¯å¾„éƒ¨åˆ†ä¼šèµ°ä»£ç†,ä¹Ÿå°±æ˜¯è¯´ä¼šä¿ç•™</li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">location </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">a</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">proxy_pass</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">http</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//127.0.0.1;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">è¯·æ±‚http</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//example/a/test.html ä¼šè¢«ä»£ç†åˆ°http://127.0.0.1/a/test.html</span></span>
<span class="line"></span></code></pre></div><ul><li><p>åœ¨proxy_passå‰é¢ç”¨äº†rewriteï¼Œå¦‚ä¸‹ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œproxy_passæ˜¯æ— æ•ˆçš„</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">location </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">getName</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">rewrite</span><span style="color:#F07178;">    </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">getName</span><span style="color:#89DDFF;">/</span><span style="color:#F07178;">([</span><span style="color:#89DDFF;">^/</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">+</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">users</span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;">name</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">$1</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">break</span><span style="color:#F07178;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">proxy_pass</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">http</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//127.0.0.1;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></li></ul><h3 id="è´Ÿè½½å‡è¡¡" tabindex="-1">è´Ÿè½½å‡è¡¡ <a class="header-anchor" href="#è´Ÿè½½å‡è¡¡" aria-hidden="true">#</a></h3><img src="/assets/image-20230321152956266.b4945e87.png" alt="image-20230321152956266" style="zoom:50%;"><ul><li><p>ä½¿ç”¨é›†ç¾¤æ˜¯ç½‘ç«™è§£å†³é«˜å¹¶å‘ã€æµ·é‡æ•°æ®é—®é¢˜çš„å¸¸ç”¨æ‰‹æ®µã€‚</p></li><li><p>å½“ä¸€å°æœåŠ¡å™¨çš„å¤„ç†èƒ½åŠ›ã€å­˜å‚¨ç©ºé—´ä¸è¶³æ—¶ï¼Œä¸è¦ä¼å›¾å»æ¢æ›´å¼ºå¤§çš„æœåŠ¡å™¨ï¼Œå¯¹å¤§å‹ç½‘ç«™è€Œè¨€ï¼Œä¸ç®¡å¤šä¹ˆå¼ºå¤§çš„æœåŠ¡å™¨ï¼Œéƒ½æ»¡è¶³ä¸äº†ç½‘ç«™æŒç»­å¢é•¿çš„ä¸šåŠ¡éœ€æ±‚ã€‚</p></li><li><p>è¿™ç§æƒ…å†µä¸‹ï¼Œæ›´æ°å½“çš„åšæ³•æ˜¯å¢åŠ ä¸€å°æœåŠ¡å™¨åˆ†æ‹…åŸæœ‰æœåŠ¡å™¨çš„è®¿é—®åŠå­˜å‚¨å‹åŠ›ã€‚é€šè¿‡è´Ÿè½½å‡è¡¡è°ƒåº¦æœåŠ¡å™¨ï¼Œå°†æ¥è‡ªæµè§ˆå™¨çš„è®¿é—®è¯·æ±‚åˆ†å‘åˆ°åº”ç”¨æœåŠ¡å™¨é›†ç¾¤ä¸­çš„ä»»ä½•ä¸€å°æœåŠ¡å™¨ä¸Šï¼Œå¦‚æœæœ‰æ›´å¤šçš„ç”¨æˆ·ï¼Œå°±åœ¨é›†ç¾¤ä¸­åŠ å…¥æ›´å¤šçš„åº”ç”¨æœåŠ¡å™¨ï¼Œä½¿åº”ç”¨æœåŠ¡å™¨çš„è´Ÿè½½å‹åŠ›ä¸å†æˆä¸ºæ•´ä¸ªç½‘ç«™çš„ç“¶é¢ˆã€‚</p></li><li><p>nginxæŠŠè¯·æ±‚è½¬å‘åˆ°åå°çš„ä¸€ç»„<code>upstream</code>æœåŠ¡æ± </p></li></ul><table><thead><tr><th style="text-align:left;">ç±»å‹</th><th style="text-align:left;">ç§ç±»</th></tr></thead><tbody><tr><td style="text-align:left;">è¯­æ³•</td><td style="text-align:left;">upstream name {}</td></tr><tr><td style="text-align:left;">é»˜è®¤</td><td style="text-align:left;">-</td></tr><tr><td style="text-align:left;">ä¸Šä¸‹æ–‡</td><td style="text-align:left;">http</td></tr></tbody></table><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> http </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">( </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">http</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> )</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> server </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">http</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createServer</span><span style="color:#A6ACCD;">( </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">request</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">response</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">response</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">end</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">server3 000</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> )</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">server</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">listen</span><span style="color:#A6ACCD;">( </span><span style="color:#F78C6C;">3000</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">,</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">( </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">HTTPæœåŠ¡å™¨å¯åŠ¨ä¸­ï¼Œç«¯å£ï¼š3000</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> )</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">upstream</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">zhufeng </span><span style="color:#A6ACCD;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">server</span><span style="color:#A6ACCD;"> 127.0.0.1:3000 </span><span style="color:#A6ACCD;font-style:italic;">weight</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  server 127.0.0.1:4000;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">server</span><span style="color:#A6ACCD;"> 127.0.0.1:5000;</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">server</span><span style="color:#A6ACCD;"> {</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">/ </span><span style="color:#A6ACCD;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#89DDFF;"> proxy_pass </span><span style="color:#A6ACCD;">http://zhufeng</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span></code></pre></div><h4 id="æœåŠ¡çŠ¶æ€" tabindex="-1">æœåŠ¡çŠ¶æ€ <a class="header-anchor" href="#æœåŠ¡çŠ¶æ€" aria-hidden="true">#</a></h4><table><thead><tr><th style="text-align:left;">çŠ¶æ€</th><th style="text-align:left;">æè¿°</th></tr></thead><tbody><tr><td style="text-align:left;">down</td><td style="text-align:left;">å½“å‰çš„æœåŠ¡å™¨ä¸å‚ä¸è´Ÿè½½å‡è¡¡</td></tr><tr><td style="text-align:left;">backup</td><td style="text-align:left;">å½“å…¶å®ƒèŠ‚ç‚¹éƒ½æ— æ³•ä½¿ç”¨æ—¶çš„å¤‡ä»½çš„æœåŠ¡å™¨</td></tr><tr><td style="text-align:left;">max_fails</td><td style="text-align:left;">å…è®¸è¯·æ±‚å¤±è´¥çš„æ¬¡æ•°,åˆ°è¾¾æœ€å¤§æ¬¡æ•°å°±ä¼šä¼‘çœ </td></tr><tr><td style="text-align:left;">fail_timeout</td><td style="text-align:left;">ç»è¿‡max_failså¤±è´¥åï¼ŒæœåŠ¡æš‚åœçš„æ—¶é—´,é»˜è®¤10ç§’</td></tr><tr><td style="text-align:left;">max_conns</td><td style="text-align:left;">é™åˆ¶æ¯ä¸ªserveræœ€å¤§çš„æ¥æ”¶çš„è¿æ¥æ•°,æ€§èƒ½é«˜çš„æœåŠ¡å™¨å¯ä»¥è¿æ¥æ•°å¤šä¸€äº›</td></tr></tbody></table><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">upstream zfpx </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">server</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">localhost</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">3000</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">down</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">server</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">localhost</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">4000</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">backup</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">server</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">localhost</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">5000</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">max_fails</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fail_timeout</span><span style="color:#89DDFF;">=</span><span style="color:#F07178;">10</span><span style="color:#A6ACCD;">s</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h4 id="åˆ†é…æ–¹å¼" tabindex="-1">åˆ†é…æ–¹å¼ <a class="header-anchor" href="#åˆ†é…æ–¹å¼" aria-hidden="true">#</a></h4><table><thead><tr><th style="text-align:left;">ç±»å‹</th><th style="text-align:left;">ç§ç±»</th></tr></thead><tbody><tr><td style="text-align:left;">è½®è¯¢(é»˜è®¤)</td><td style="text-align:left;">æ¯ä¸ªè¯·æ±‚æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨ï¼Œå¦‚æœåç«¯æœåŠ¡å™¨downæ‰ï¼Œèƒ½è‡ªåŠ¨å‰”é™¤</td></tr><tr><td style="text-align:left;">weight(åŠ æƒè½®è¯¢)</td><td style="text-align:left;">æŒ‡å®šè½®è¯¢å‡ ç‡ï¼Œweightå’Œè®¿é—®æ¯”ç‡æˆæ­£æ¯”ï¼Œç”¨äºåç«¯æœåŠ¡å™¨æ€§èƒ½ä¸å‡çš„æƒ…å†µ</td></tr><tr><td style="text-align:left;">ip_hash</td><td style="text-align:left;">æ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—®ipçš„hashç»“æœåˆ†é…ï¼Œè¿™æ ·æ¯ä¸ªè®¿å®¢å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œå¯ä»¥è§£å†³sessionçš„é—®é¢˜</td></tr><tr><td style="text-align:left;">least_conn</td><td style="text-align:left;">å“ªä¸ªæœºå™¨ä¸Šè¿æ¥æ•°å°‘å°±åˆ†å‘ç»™è°</td></tr><tr><td style="text-align:left;">url_hash(ç¬¬ä¸‰æ–¹)</td><td style="text-align:left;">æŒ‰è®¿é—®çš„URLåœ°å€æ¥åˆ†é… è¯·æ±‚ï¼Œæ¯ä¸ªURLéƒ½å®šå‘åˆ°åŒä¸€ä¸ªåç«¯ æœåŠ¡å™¨ä¸Š(ç¼“å­˜)</td></tr><tr><td style="text-align:left;">fair(ç¬¬ä¸‰æ–¹)</td><td style="text-align:left;">æŒ‰åç«¯æœåŠ¡å™¨çš„å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚ï¼Œå“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…</td></tr><tr><td style="text-align:left;">æ­£å®šä¹‰hash</td><td style="text-align:left;">hashè‡ªå®šä¹‰key</td></tr></tbody></table><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">upstream</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">zhufeng</span><span style="color:#A6ACCD;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">ip_hash;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">server</span><span style="color:#A6ACCD;"> 127.0.0.1:3000;</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#C792EA;">upstream</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">zhufeng</span><span style="color:#A6ACCD;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">least_conn;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">server</span><span style="color:#A6ACCD;"> 127.0.0.1:3000;</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#C792EA;">upstream</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">zhufeng</span><span style="color:#A6ACCD;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  url_hash;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">server</span><span style="color:#A6ACCD;"> 127.0.0.1:3000;</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#C792EA;">upstream</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">zhufeng</span><span style="color:#A6ACCD;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  fair;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">server</span><span style="color:#A6ACCD;"> 127.0.0.1:3000;</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#C792EA;">upstream</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">zhufeng</span><span style="color:#A6ACCD;">{</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;"> hash $</span><span style="color:#A6ACCD;">request_uri</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">server</span><span style="color:#A6ACCD;"> 127.0.0.1:3000;</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="_16-ç¼“å­˜" tabindex="-1">16. ç¼“å­˜ <a class="header-anchor" href="#_16-ç¼“å­˜" aria-hidden="true">#</a></h2><ul><li>åº”ç”¨æœåŠ¡å™¨ç«¯ç¼“å­˜</li><li>ä»£ç†ç¼“å­˜</li><li>å®¢æˆ·ç«¯ç¼“å­˜</li></ul><p><a href="https://blog.csdn.net/dengjiexian123/article/details/53386586" target="_blank" rel="noreferrer">proxy_cache</a></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">http</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">  </span></span>
<span class="line"><span style="color:#F07178;">    # </span><span style="color:#A6ACCD;">ç¼“å­˜è·¯å¾„</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ç›®å½•å±‚çº§</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ç¼“å­˜ç©ºé—´åç§°å’Œå¤§å°</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">å¤±æ•ˆæ—¶é—´ä¸º7å¤©</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">æœ€å¤§å®¹é‡ä¸º10g</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">proxy_cache_path</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">data</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">nginx</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">cache</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">levels</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">:</span><span style="color:#F78C6C;">2</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">keys_zone</span><span style="color:#89DDFF;">=</span><span style="color:#FFCB6B;">cache</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;">100</span><span style="color:#A6ACCD;">m</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">inactive</span><span style="color:#89DDFF;">=</span><span style="color:#F07178;">60</span><span style="color:#A6ACCD;">m</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">max_size</span><span style="color:#89DDFF;">=</span><span style="color:#F07178;">10</span><span style="color:#A6ACCD;">g</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;">  </span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"></span></code></pre></div><table><thead><tr><th style="text-align:left;">é”®å€¼</th><th style="text-align:left;">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:left;">proxy_cache_path</td><td style="text-align:left;">ç¼“å­˜æ–‡ä»¶è·¯å¾„</td></tr><tr><td style="text-align:left;">levels</td><td style="text-align:left;">è®¾ç½®ç¼“å­˜æ–‡ä»¶ç›®å½•å±‚æ¬¡ï¼›levels=1:2 è¡¨ç¤ºä¸¤çº§ç›®å½•</td></tr><tr><td style="text-align:left;">keys_zone</td><td style="text-align:left;">è®¾ç½®ç¼“å­˜åå­—å’Œå…±äº«å†…å­˜å¤§å°</td></tr><tr><td style="text-align:left;">inactive</td><td style="text-align:left;">åœ¨æŒ‡å®šæ—¶é—´å†…æ²¡äººè®¿é—®åˆ™è¢«åˆ é™¤</td></tr><tr><td style="text-align:left;">max_size</td><td style="text-align:left;">æœ€å¤§ç¼“å­˜ç©ºé—´ï¼Œå¦‚æœç¼“å­˜ç©ºé—´æ»¡ï¼Œé»˜è®¤è¦†ç›–æ‰ç¼“å­˜æ—¶é—´æœ€é•¿çš„èµ„æº</td></tr></tbody></table><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> ($request_uri </span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">^</span><span style="color:#89DDFF;">/</span><span style="color:#C3E88D;">cache</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">(login</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">logout)) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">set</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">$nocache</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    location </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">       </span><span style="color:#A6ACCD;">proxy_pass</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">http</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//zhufeng;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    location </span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">^</span><span style="color:#89DDFF;">/</span><span style="color:#C3E88D;">cache</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">proxy_cache</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">cache</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">proxy_cache_valid</span><span style="color:#F07178;">  </span><span style="color:#F78C6C;">200</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">206</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">304</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">301</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">302</span><span style="color:#F07178;"> 60</span><span style="color:#A6ACCD;">m</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;">   # </span><span style="color:#A6ACCD;">å¯¹å“ªäº›çŠ¶æ€ç ç¼“å­˜</span><span style="color:#F07178;">ï¼Œ</span><span style="color:#A6ACCD;">è¿‡æœŸæ—¶é—´ä¸º60åˆ†é’Ÿ</span></span>
<span class="line"><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">proxy_cache_key</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">$uri</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;">  #</span><span style="color:#A6ACCD;">ç¼“å­˜çš„ç»´åº¦</span></span>
<span class="line"><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">proxy_no_cache</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">$nocache</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">proxy_set_header</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Host</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">$host</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">$server_port</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;">  #</span><span style="color:#A6ACCD;">è®¾ç½®å¤´</span></span>
<span class="line"><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">proxy_set_header</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">X</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">Real</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">IP</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">$remote_addr</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;">   #</span><span style="color:#A6ACCD;">è®¾ç½®å¤´</span></span>
<span class="line"><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">proxy_set_header</span><span style="color:#F07178;">   </span><span style="color:#A6ACCD;">X</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">Forwarded</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">For</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">$proxy_add_x_forwarded_for</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;">   #</span><span style="color:#A6ACCD;">è®¾ç½®å¤´</span></span>
<span class="line"><span style="color:#F07178;">     </span><span style="color:#A6ACCD;">proxy_pass</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">http</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//127.0.0.1:6000;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><table><thead><tr><th style="text-align:left;">é”®å€¼</th><th style="text-align:left;">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:left;">proxy_cache</td><td style="text-align:left;">ä½¿ç”¨åä¸ºcacheçš„å¯¹åº”ç¼“å­˜é…ç½®</td></tr><tr><td style="text-align:left;">proxy_cache_valid 200 206 304 301 302 10d;</td><td style="text-align:left;">å¯¹httpcodeä¸º200çš„ç¼“å­˜10å¤©</td></tr><tr><td style="text-align:left;">proxy_cache_key $uri</td><td style="text-align:left;">å®šä¹‰ç¼“å­˜å”¯ä¸€key,é€šè¿‡å”¯ä¸€keyæ¥è¿›è¡Œhashå­˜å–</td></tr><tr><td style="text-align:left;">proxy_set_header</td><td style="text-align:left;">è‡ªå®šä¹‰http headerå¤´ï¼Œç”¨äºå‘é€ç»™åç«¯çœŸå®æœåŠ¡å™¨</td></tr><tr><td style="text-align:left;">proxy_pass</td><td style="text-align:left;">æŒ‡ä»£ç†åè½¬å‘çš„è·¯å¾„ï¼Œæ³¨æ„æ˜¯å¦éœ€è¦æœ€åçš„/</td></tr></tbody></table><h2 id="location" tabindex="-1">location <a class="header-anchor" href="#location" aria-hidden="true">#</a></h2><h3 id="_1-æ­£åˆ™è¡¨è¾¾å¼" tabindex="-1">1 æ­£åˆ™è¡¨è¾¾å¼ <a class="header-anchor" href="#_1-æ­£åˆ™è¡¨è¾¾å¼" aria-hidden="true">#</a></h3><table><thead><tr><th style="text-align:left;">ç±»å‹</th><th style="text-align:left;">ç§ç±»</th></tr></thead><tbody><tr><td style="text-align:left;">.</td><td style="text-align:left;">åŒ¹é…é™¤æ¢è¡Œç¬¦ä¹‹å¤–çš„ä»»æ„å­—ç¬¦</td></tr><tr><td style="text-align:left;">?</td><td style="text-align:left;">é‡å¤0æ¬¡æˆ–1æ¬¡</td></tr><tr><td style="text-align:left;">+</td><td style="text-align:left;">é‡å¤1æ¬¡æˆ–æ›´å¤šæ¬¡</td></tr><tr><td style="text-align:left;">*</td><td style="text-align:left;">é‡å¤é›¶æ¬¡æˆ–å¤šæ¬¡</td></tr><tr><td style="text-align:left;">^</td><td style="text-align:left;">åŒ¹é…å­—ç¬¦ä¸²çš„å¼€å§‹</td></tr><tr><td style="text-align:left;">$</td><td style="text-align:left;">åŒ¹é…å­—ç¬¦ä¸²çš„ç»“æŸ</td></tr><tr><td style="text-align:left;" n=""></td><td style="text-align:left;">é‡å¤næ¬¡</td></tr><tr><td style="text-align:left;" n,=""></td><td style="text-align:left;">é‡å¤næ¬¡æˆ–æ›´å¤šæ¬¡</td></tr><tr><td style="text-align:left;">[abc]</td><td style="text-align:left;">åŒ¹é…å•ä¸ªå­—ç¬¦aæˆ–è€…bæˆ–è€…c</td></tr><tr><td style="text-align:left;">a-z</td><td style="text-align:left;">åŒ¹é…a-zå°å†™å­—æ¯çš„ä»»æ„ä¸€ä¸ª</td></tr><tr><td style="text-align:left;">\</td><td style="text-align:left;">è½¬ä¹‰å­—ç¬¦</td></tr><tr><td style="text-align:left;">()</td><td style="text-align:left;">ç”¨äºåŒ¹é…æ‹¬å·ä¹‹é—´çš„å†…å®¹ï¼Œå¯ä»¥é€šè¿‡$1ã€$2å¼•ç”¨</td></tr><tr><td style="text-align:left;">\w</td><td style="text-align:left;">çš„é‡Šä¹‰éƒ½æ˜¯æŒ‡åŒ…å«å¤§ å°å†™å­—æ¯æ•°å­—å’Œä¸‹åˆ’çº¿ ç›¸å½“äº([0-9a-zA-Z])</td></tr></tbody></table><h3 id="_2-è¯­æ³•è§„åˆ™" tabindex="-1">2 è¯­æ³•è§„åˆ™ <a class="header-anchor" href="#_2-è¯­æ³•è§„åˆ™" aria-hidden="true">#</a></h3><ul><li>locationä»…åŒ¹é…URIï¼Œå¿½ç•¥å‚æ•°</li><li>å‰ç¼€å­—ç¬¦ä¸² <ul><li>å¸¸è§„</li><li>= ç²¾ç¡®åŒ¹é…</li><li>^~ åŒ¹é…ä¸Šååˆ™ä¸å†è¿›è¡Œæ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…</li></ul></li><li>æ­£åˆ™è¡¨è¾¾å¼ <ul><li>~ å¤§å°å†™æ•æ„Ÿçš„æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…</li><li>~*å¿½ç•¥å¤§å°å†™çš„æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…</li></ul></li><li>å†…éƒ¨è°ƒè½¬ <ul><li>ç”¨äºå†…éƒ¨è·³è½¬çš„å‘½ålocation @</li></ul></li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">Syntax location [</span><span style="color:#89DDFF;">=|~|~*|^~</span><span style="color:#A6ACCD;">] uri </span><span style="color:#89DDFF;">{...}</span></span>
<span class="line"><span style="color:#A6ACCD;">       location </span><span style="color:#89DDFF;">@</span><span style="color:#A6ACCD;">name</span><span style="color:#89DDFF;">{...}</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-</span></span>
<span class="line"><span style="color:#A6ACCD;">Context server</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">location       </span></span>
<span class="line"></span></code></pre></div><h3 id="_3-åŒ¹é…è§„åˆ™" tabindex="-1">3 åŒ¹é…è§„åˆ™ <a class="header-anchor" href="#_3-åŒ¹é…è§„åˆ™" aria-hidden="true">#</a></h3><ul><li>ç­‰å·ç±»å‹ï¼ˆ=ï¼‰çš„ä¼˜å…ˆçº§æœ€é«˜ã€‚ä¸€æ—¦åŒ¹é…æˆåŠŸï¼Œåˆ™ä¸å†æŸ¥æ‰¾å…¶ä»–åŒ¹é…é¡¹ã€‚</li><li>^~ç±»å‹è¡¨è¾¾å¼ã€‚ä¸€æ—¦åŒ¹é…æˆåŠŸï¼Œåˆ™ä¸å†æŸ¥æ‰¾å…¶ä»–åŒ¹é…é¡¹ã€‚</li><li>æ­£åˆ™è¡¨è¾¾å¼ç±»å‹ï¼ˆ~ ~*ï¼‰çš„ä¼˜å…ˆçº§æ¬¡ä¹‹ã€‚å¦‚æœæœ‰å¤šä¸ªlocationçš„æ­£åˆ™èƒ½åŒ¹é…çš„è¯ï¼Œåˆ™ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æœ€é•¿çš„é‚£ä¸ªã€‚</li><li>å¸¸è§„å­—ç¬¦ä¸²åŒ¹é…ç±»å‹æŒ‰å‰ç¼€åŒ¹é…</li></ul><img src="/assets/image-20230321153514596.0ef33a0a.png" alt="image-20230321153514596" style="zoom:50%;"><h3 id="_4-æ¡ˆä¾‹" tabindex="-1">4 æ¡ˆä¾‹ <a class="header-anchor" href="#_4-æ¡ˆä¾‹" aria-hidden="true">#</a></h3><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">location </span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">T1</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">$ </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">200</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">åŒ¹é…åˆ°ç¬¬ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">location </span><span style="color:#89DDFF;">~*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">/</span><span style="color:#C3E88D;">T1</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">(\w</span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;">)$ </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">200</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">åŒ¹é…åˆ°æœ€é•¿çš„æ­£åˆ™è¡¨è¾¾å¼</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">location </span><span style="color:#89DDFF;">^~</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">/</span><span style="color:#C3E88D;">T1</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">200</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">åœæ­¢åç»­çš„æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">location  </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">T1</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">T2 </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">200</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">æœ€é•¿çš„å‰ç¼€è¡¨è¾¾å¼åŒ¹é…</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">location  </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">T1 </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">200</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">å‰ç¼€è¡¨è¾¾å¼åŒ¹é…</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">location </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">T1 </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">200</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ç²¾ç¡®åŒ¹é…</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">T1     </span><span style="color:#676E95;font-style:italic;">//ç²¾ç¡®åŒ¹é…</span></span>
<span class="line"><span style="color:#89DDFF;">/</span><span style="color:#C3E88D;">T1</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">//åœæ­¢åç»­çš„æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…</span></span>
<span class="line"><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">T1</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">T2  </span><span style="color:#676E95;font-style:italic;">//åŒ¹é…åˆ°æœ€é•¿çš„æ­£åˆ™è¡¨è¾¾å¼</span></span>
<span class="line"><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">T1</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">T2</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">//æœ€é•¿çš„å‰ç¼€è¡¨è¾¾å¼åŒ¹é…</span></span>
<span class="line"><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">t1</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">T2  </span><span style="color:#676E95;font-style:italic;">//åŒ¹é…åˆ°æœ€é•¿çš„æ­£åˆ™è¡¨è¾¾å¼</span></span>
<span class="line"></span></code></pre></div><h2 id="_18-rewrite" tabindex="-1">18. rewrite <a class="header-anchor" href="#_18-rewrite" aria-hidden="true">#</a></h2><ul><li>å¯ä»¥å®ç°urlé‡å†™åŠé‡å®šå‘</li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#FFCB6B;">syntax</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> rewrite regex replacement [flag]</span></span>
<span class="line"><span style="color:#FFCB6B;">Default</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> â€”</span></span>
<span class="line"><span style="color:#FFCB6B;">Context</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> server</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> location</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">if</span></span>
<span class="line"></span></code></pre></div><ul><li>å¦‚æœæ­£åˆ™è¡¨è¾¾å¼ï¼ˆregexï¼‰åŒ¹é…åˆ°äº†è¯·æ±‚çš„URIï¼ˆrequest URIï¼‰ï¼Œè¿™ä¸ªURIä¼šè¢«åé¢çš„replacementæ›¿æ¢</li><li>rewriteçš„å®šå‘ä¼šæ ¹æ®ä»–ä»¬åœ¨é…ç½®æ–‡ä»¶ä¸­å‡ºç°çš„é¡ºåºä¾æ¬¡æ‰§è¡Œ</li><li>é€šè¿‡ä½¿ç”¨flagå¯ä»¥ç»ˆæ­¢å®šå‘åè¿›ä¸€æ­¥çš„å¤„ç†</li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">rewrite </span><span style="color:#89DDFF;">^</span><span style="color:#89DDFF;">/</span><span style="color:#C3E88D;">users</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">.*</span><span style="color:#A6ACCD;">)$ </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">show</span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;">user</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">$1</span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;"> last;</span><span style="color:#89DDFF;">=</span></span>
<span class="line"></span></code></pre></div><h3 id="_18-1-ç”¨é€”" tabindex="-1">18.1 ç”¨é€” <a class="header-anchor" href="#_18-1-ç”¨é€”" aria-hidden="true">#</a></h3><ul><li>URLé¡µé¢è·³è½¬</li><li>å…¼å®¹æ—§ç‰ˆæœ¬</li><li>SEOä¼˜åŒ–(ä¼ªé™æ€)</li><li>ç»´æŠ¤(åå°ç»´æŠ¤ã€æµé‡è½¬å‘)</li><li>å®‰å…¨(ä¼ªé™æ€)</li></ul><h3 id="_18-2-è¯­æ³•" tabindex="-1">18.2 è¯­æ³• <a class="header-anchor" href="#_18-2-è¯­æ³•" aria-hidden="true">#</a></h3><table><thead><tr><th style="text-align:left;">ç±»å‹</th><th style="text-align:left;">ç§ç±»</th></tr></thead><tbody><tr><td style="text-align:left;">è¯­æ³•</td><td style="text-align:left;">rewrite regex replacement [flag]</td></tr><tr><td style="text-align:left;">é»˜è®¤</td><td style="text-align:left;">-</td></tr><tr><td style="text-align:left;">ä¸Šä¸‹æ–‡</td><td style="text-align:left;">server,location,if</td></tr></tbody></table><ul><li>regex æ­£åˆ™è¡¨è¾¾å¼æŒ‡çš„æ˜¯è¦è¢«æ”¹å†™çš„è·¯å¾„</li><li>replacement ç›®æ ‡è¦æ›¿æ¢æˆå“ªä¸ªURL</li><li>flag æ ‡è¯†</li></ul><p>å®ä¾‹</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">rewrite </span><span style="color:#89DDFF;">^</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">.*</span><span style="color:#A6ACCD;">)$ </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">www</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">reparing</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">html </span><span style="color:#89DDFF;font-style:italic;">break</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="_18-3-flag" tabindex="-1">18.3 flag <a class="header-anchor" href="#_18-3-flag" aria-hidden="true">#</a></h3><ul><li>æ ‡å¿—ä½æ˜¯æ ‡è¯†è§„åˆ™å¯¹åº”çš„ç±»å‹</li></ul><table><thead><tr><th style="text-align:left;">flag</th><th style="text-align:left;">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:left;">last</td><td style="text-align:left;">å…ˆåŒ¹é…è‡ªå·±çš„location,ç„¶åé€šè¿‡rewriteè§„åˆ™æ–°å»ºä¸€ä¸ªè¯·æ±‚å†æ¬¡è¯·æ±‚æœåŠ¡ç«¯</td></tr><tr><td style="text-align:left;">break</td><td style="text-align:left;">å…ˆåŒ¹é…è‡ªå·±çš„location,ç„¶åç”Ÿå‘½å‘¨æœŸä¼šåœ¨å½“å‰çš„locationç»“æŸ,ä¸å†è¿›è¡Œåç»­çš„åŒ¹é…</td></tr><tr><td style="text-align:left;">redirect</td><td style="text-align:left;">è¿”å›302æ˜¨æ—¶é‡å®šå‘,ä»¥åè¿˜ä¼šè¯·æ±‚è¿™ä¸ªæœåŠ¡å™¨</td></tr><tr><td style="text-align:left;">permanent</td><td style="text-align:left;">è¿”å›301æ°¸ä¹…é‡å®šå‘,ä»¥åä¼šç›´æ¥è¯·æ±‚æ°¸ä¹…é‡å®šå‘åçš„åŸŸå</td></tr></tbody></table><h4 id="_18-3-1-last" tabindex="-1">18.3.1 last <a class="header-anchor" href="#_18-3-1-last" aria-hidden="true">#</a></h4><ul><li>ç»“æŸå½“å‰çš„è¯·æ±‚å¤„ç†,ç”¨æ›¿æ¢åçš„URIé‡æ–°åŒ¹é…<code>location</code></li><li>å¯ç†è§£ä¸ºé‡å†™ï¼ˆrewriteï¼‰åï¼Œå‘èµ·äº†ä¸€ä¸ªæ–°è¯·æ±‚ï¼Œè¿›å…¥serveræ¨¡å—ï¼ŒåŒ¹é…location</li><li>å¦‚æœé‡æ–°åŒ¹é…å¾ªç¯çš„æ¬¡æ•°è¶…è¿‡10æ¬¡ï¼Œnginxä¼šè¿”å›500é”™è¯¯</li><li>è¿”å›302 httpçŠ¶æ€ç </li><li>æµè§ˆå™¨åœ°å€æ æ˜¾ç¤ºé‡å®šå‘åçš„url</li></ul><h4 id="_18-3-2-break" tabindex="-1">18.3.2 break <a class="header-anchor" href="#_18-3-2-break" aria-hidden="true">#</a></h4><ul><li>ç»“æŸå½“å‰çš„è¯·æ±‚å¤„ç†ï¼Œä½¿ç”¨å½“å‰èµ„æºï¼Œä¸å†æ‰§è¡Œlocationé‡Œä½™ä¸‹çš„è¯­å¥</li><li>è¿”å›302 httpçŠ¶æ€ç </li><li>æµè§ˆå™¨åœ°å€æ æ˜¾ç¤ºé‡å®šå‘åçš„url</li></ul><h4 id="_18-3-3-redirect" tabindex="-1">18.3.3 redirect <a class="header-anchor" href="#_18-3-3-redirect" aria-hidden="true">#</a></h4><ul><li>ä¸´æ—¶è·³è½¬ï¼Œè¿”å›302 httpçŠ¶æ€ç </li><li>æµè§ˆå™¨åœ°å€æ æ˜¾ç¤ºé‡åœ°å‘åçš„url</li></ul><h4 id="_18-3-4-permanent" tabindex="-1">18.3.4 permanent <a class="header-anchor" href="#_18-3-4-permanent" aria-hidden="true">#</a></h4><ul><li>æ°¸ä¹…è·³è½¬ï¼Œè¿”å›301 httpçŠ¶æ€ç ï¼›</li><li>æµè§ˆå™¨åœ°å€æ æ˜¾ç¤ºé‡å®šå‘åçš„url</li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">location </span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">^/</span><span style="color:#89DDFF;font-style:italic;">break</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">rewrite</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">^/</span><span style="color:#89DDFF;font-style:italic;">break</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">test</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">break</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">root</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">data</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">html</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">location </span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">^/</span><span style="color:#A6ACCD;">last </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">rewrite</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">^/</span><span style="color:#A6ACCD;">last</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">test</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">last</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">location </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">test </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">default_type</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">application</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">json</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">200</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{&quot;code&quot;:0,&quot;msg&quot;:&quot;success&quot;}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">location </span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">^/</span><span style="color:#A6ACCD;">redirect </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">rewrite</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">^/</span><span style="color:#A6ACCD;">redirect</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">http</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//www.baidu.com redirect;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">location </span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">^/</span><span style="color:#A6ACCD;">permanent </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">rewrite</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">^/</span><span style="color:#A6ACCD;">permanent</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">http</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//www.baidu.com permanent;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">curl </span><span style="color:#FFCB6B;">http</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//115.29.148.6/break</span></span>
<span class="line"><span style="color:#A6ACCD;">test</span></span>
<span class="line"><span style="color:#A6ACCD;">curl </span><span style="color:#FFCB6B;">http</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//115.29.148.6/last</span></span>
<span class="line"><span style="color:#89DDFF;">{</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">code</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">:</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">msg</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">success</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">curl </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">vL </span><span style="color:#FFCB6B;">http</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//115.29.148.6/redirect</span></span>
<span class="line"><span style="color:#A6ACCD;">curl </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">vL http</span></span>
<span class="line"></span></code></pre></div></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-c5936a1e data-v-e033cd21><div class="edit-info" data-v-e033cd21><div class="edit-link" data-v-e033cd21><a class="VPLink link edit-link-button" href="https://github.com/wendaobai/wendaobai.github.io/edit/master/docs/å‰ç«¯è¿ç»´/Linux/nginx.md" target="_blank" rel="noreferrer" data-v-e033cd21 data-v-30c06bd3><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="edit-link-icon" data-v-e033cd21><path d="M18,23H4c-1.7,0-3-1.3-3-3V6c0-1.7,1.3-3,3-3h7c0.6,0,1,0.4,1,1s-0.4,1-1,1H4C3.4,5,3,5.4,3,6v14c0,0.6,0.4,1,1,1h14c0.6,0,1-0.4,1-1v-7c0-0.6,0.4-1,1-1s1,0.4,1,1v7C21,21.7,19.7,23,18,23z"></path><path d="M8,17c-0.3,0-0.5-0.1-0.7-0.3C7,16.5,6.9,16.1,7,15.8l1-4c0-0.2,0.1-0.3,0.3-0.5l9.5-9.5c1.2-1.2,3.2-1.2,4.4,0c1.2,1.2,1.2,3.2,0,4.4l-9.5,9.5c-0.1,0.1-0.3,0.2-0.5,0.3l-4,1C8.2,17,8.1,17,8,17zM9.9,12.5l-0.5,2.1l2.1-0.5l9.3-9.3c0.4-0.4,0.4-1.1,0-1.6c-0.4-0.4-1.2-0.4-1.6,0l0,0L9.9,12.5z M18.5,2.5L18.5,2.5L18.5,2.5z"></path></svg> æ›´æ­£é”™è¯¯<!--]--><!----></a></div><!----></div><div class="prev-next" data-v-e033cd21><div class="pager" data-v-e033cd21><a class="pager-link prev" href="/%E5%89%8D%E7%AB%AF%E8%BF%90%E7%BB%B4/Linux/linux%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4.html" data-v-e033cd21><span class="desc" data-v-e033cd21>Previous page</span><span class="title" data-v-e033cd21>linuxå¸¸è§å‘½ä»¤</span></a></div><div class="has-prev pager" data-v-e033cd21><a class="pager-link next" href="/%E5%89%8D%E7%AB%AF%E8%BF%90%E7%BB%B4/Linux/vim.html" data-v-e033cd21><span class="desc" data-v-e033cd21>Next page</span><span class="title" data-v-e033cd21>vim</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><footer class="VPFooter has-sidebar" data-v-93a960b4 data-v-d24360a6><div class="container" data-v-d24360a6><p class="message" data-v-d24360a6>MIT Licensed | Copyright Â© 2021 - 2022</p><p class="copyright" data-v-d24360a6>ç²¤ICPå¤‡2021165391å·</p></div></footer><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"readme.md\":\"ed15d567\",\"index.md\":\"35255a35\",\"js_interview_1.å®ç°newå®ä¾‹åŒ–å¯¹è±¡.md\":\"71a61545\",\"js_interview_2.å®ç°call-apply-bind.md\":\"db722d0e\",\"js_åŸºç¡€_3.åŸå‹é“¾.md\":\"e6fb6b78\",\"å‰ç«¯è¿ç»´_linux_vim.md\":\"7ecdc953\",\"js_interview_4.å®ç°ç»§æ‰¿.md\":\"d6a0d2a4\",\"js_interview_3.å®ç°instanceof.md\":\"c9b933a1\",\"js_es6_1.letå’Œconstå˜é‡å£°æ˜.md\":\"34cd15c6\",\"å‰ç«¯è¿ç»´_linux_linuxå¸¸è§å‘½ä»¤.md\":\"0e42b77c\",\"js_es6_5.ç®­å¤´å‡½æ•°.md\":\"593ba449\",\"js_åŸºç¡€_2.ä½œç”¨åŸŸ.md\":\"9cfe450c\",\"å‰ç«¯è¿ç»´_linux_docker.md\":\"5ec0616d\",\"js_åŸºç¡€_1.å¯æ‰§è¡Œä¸Šä¸‹æ–‡.md\":\"f2afeeeb\",\"å‰ç«¯è¿ç»´_linux_nginx.md\":\"2e355d65\",\"js_es6_3.symbolæ•°æ®ç±»å‹.md\":\"972c6292\",\"js_es6_4.proxyä»£ç†å™¨.md\":\"8997d5cc\",\"js_es6_2.setä¸mapæ•°æ®ç»“æ„.md\":\"34ff9b87\"}")</script>
    <script type="module" async src="/assets/app.0c9f1ae8.js"></script>
    
  </body>
</html>